function t(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}function e(t){return t&&t.__esModule?t.default:t}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},i={},o=n.parcelRequirea635;null==o&&(o=function(t){if(t in r)return r[t].exports;if(t in i){var e=i[t];delete i[t];var n={id:t,exports:{}};return r[t]=n,e.call(n.exports,n,n.exports),n.exports}var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o},o.register=function(t,e){i[t]=e},n.parcelRequirea635=o),o.register("kyEFX",(function(e,n){var r,i;t(e.exports,"register",(function(){return r}),(function(t){return r=t})),t(e.exports,"resolve",(function(){return i}),(function(t){return i=t}));var o={};r=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)o[e[n]]=t[e[n]]},i=function(t){var e=o[t];if(null==e)throw new Error("Could not resolve bundle with id "+t);return e}})),o("kyEFX").register(JSON.parse('{"e5iw0":"index.be9dbe4f.js","iZtgb":"studio017.24ccf04d.jpg"}'));var s={};
/*! Tweakpane 3.0.7 (c) 2016 cocopon, licensed under the MIT license. */function a(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t).value}function l(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");var r=e.get(t);if(!r.writable)throw new TypeError("attempted to set read only private field");return r.value=n,n}function u(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}
/* @license twgl.js 4.21.2 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */!function(t,e){"object"==typeof s?e(s):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Tweakpane={})}(s,(function(t){class e{get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}constructor(t){this.controller_=t}}class n{constructor(t){this.target=t}}class r extends n{constructor(t,e,n,r){super(t),this.value=e,this.presetKey=n,this.last=null==r||r}}class i extends n{constructor(t,e,n){super(t),this.value=e,this.presetKey=n}}class o extends n{constructor(t,e){super(t),this.expanded=e}}function s(t){return null==t}function a(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}const l={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class u{static alreadyDisposed(){return new u({type:"alreadydisposed"})}static notBindable(){return new u({type:"notbindable"})}static propertyNotFound(t){return new u({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new u({type:"shouldneverhappen"})}constructor(t){var e;this.message=null!==(e=l[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}}class c{static isBindable(t){return null!==t&&"object"==typeof t}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(t){this.obj_[this.key_]=t}writeProperty(t,e){const n=this.read();if(!c.isBindable(n))throw u.notBindable();if(!(t in n))throw u.propertyNotFound(t);n[t]=e}constructor(t,e,n){this.obj_=t,this.key_=e,this.presetKey_=null!=n?n:e}}class h extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get title(){var t;return null!==(t=this.controller_.valueController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.valueController.props.set("title",t)}on(t,e){const r=e.bind(this);return this.controller_.valueController.emitter.on(t,(()=>{r(new n(this))})),this}}class d{on(t,e){let n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}off(t,e){const n=this.observers_[t];return n&&(this.observers_[t]=n.filter((t=>t.handler!==e))),this}emit(t,e){const n=this.observers_[t];n&&n.forEach((t=>{t.handler(e)}))}constructor(){this.observers_={}}}const p="tp";function v(t){return(e,n)=>[p,"-",t,"v",e?`_${e}`:"",n?`-${n}`:""].join("")}function f(t){return t.rawValue}function m(t,e){var n,r;t.emitter.on("change",(n=f,r=e,t=>r(n(t)))),e(t.rawValue)}function b(t,e,n){m(t.value(e),n)}function _(t,e){return n=>{!function(t,e,n){n?t.classList.add(e):t.classList.remove(e)}(t,e,n)}}function g(t,e){m(t,(t=>{e.textContent=null!=t?t:""}))}const w=v("btn");class x{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(w()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("button");n.classList.add(w("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const r=t.createElement("div");r.classList.add(w("t")),g(e.props.value("title"),r),this.buttonElement.appendChild(r)}}class C{onClick_(){this.emitter.emit("click",{sender:this})}constructor(t,e){this.emitter=new d,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new x(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}}class E{get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=null!=e?e:{forceEmit:!1,last:!0},r=this.constraint_?this.constraint_.constrain(t):t;(!this.equals_(this.rawValue_,r)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=r,this.emitter.emit("change",{options:n,rawValue:r,sender:this}))}constructor(t,e){var n;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(n=null==e?void 0:e.equals)&&void 0!==n?n:(t,e)=>t===e,this.emitter=new d,this.rawValue_=t}}class y{get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=null!=e?e:{forceEmit:!1,last:!0};(this.value_!==t||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,rawValue:this.value_,sender:this}))}constructor(t){this.emitter=new d,this.value_=t}}function P(t,e){const n=null==e?void 0:e.constraint,r=null==e?void 0:e.equals;return n||r?new E(t,e):new y(t)}class T{static createCore(t){return Object.keys(t).reduce(((e,n)=>Object.assign(e,{[n]:P(t[n])})),{})}static fromObject(t){const e=this.createCore(t);return new T(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}constructor(t){this.emitter=new d,this.valMap_=t;for(const t in this.valMap_){this.valMap_[t].emitter.on("change",(()=>{this.emitter.emit("change",{key:t,sender:this})}))}}}function M(t){return e=>n=>{if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};const r=t(n);return void 0!==r?{succeeded:!0,value:r}:{succeeded:!1,value:void 0}}}function k(t){return{custom:e=>M(e)(t),boolean:M((t=>"boolean"==typeof t?t:void 0))(t),number:M((t=>"number"==typeof t?t:void 0))(t),string:M((t=>"string"==typeof t?t:void 0))(t),function:M((t=>"function"==typeof t?t:void 0))(t),constant:e=>M((t=>t===e?e:void 0))(t),raw:M((t=>t))(t),object:e=>M((t=>{var n;if(null!==(n=t)&&"object"==typeof n)return function(t,e){return Object.keys(e).reduce(((n,r)=>{if(void 0===n)return;const i=(0,e[r])(t[r]);return i.succeeded?Object.assign(Object.assign({},n),{[r]:i.value}):void 0}),{})}(t,e)}))(t),array:e=>M((t=>{var n;if(Array.isArray(t))return n=e,t.reduce(((t,e)=>{if(void 0===t)return;const r=n(e);return r.succeeded&&void 0!==r.value?[...t,r.value]:void 0}),[])}))(t)}}const A={optional:k(!0),required:k(!1)};function S(t,e){const n=A.required.object(e)(t);return n.succeeded?n.value:void 0}const F=v(""),R={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class B{get parent(){return this.parent_}constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{["veryfirst","first","last","verylast"].forEach((t=>{e.classList.remove(F(void 0,R[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(F(void 0,R[t]))}))})),this.viewProps.handleDispose((()=>{!function(t){t&&t.parentElement&&t.parentElement.removeChild(t)}(e)}))}}const V="http://www.w3.org/2000/svg";function L(t){t.offsetHeight}function D(t){return void 0!==t.ontouchstart}function U(){return new Function("return this")().document}const I={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function O(t,e){const n=t.createElementNS(V,"svg");return n.innerHTML=I[e],n}function N(t,e,n){t.insertBefore(e,t.children[n])}function z(t){t.parentElement&&t.parentElement.removeChild(t)}function j(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function H(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}const K=v("lbl");class G{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(K()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(K("l")),b(e.props,"label",(e=>{s(e)?this.element.classList.add(K(void 0,"nol")):(this.element.classList.remove(K(void 0,"nol")),function(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}(n),n.appendChild(function(t,e){const n=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,r)=>{r>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}(t,e)))})),this.element.appendChild(n),this.labelElement=n;const r=t.createElement("div");r.classList.add(K("v")),this.element.appendChild(r),this.valueElement=r}}class W extends B{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new G(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const q={id:"button",type:"blade",accept(t){const e=A,n=S(t,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return n?{params:n}:null},controller:t=>new W(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:new C(t.document,{props:T.fromObject({title:t.params.title}),viewProps:t.viewProps})}),api:t=>t.controller instanceof W&&t.controller.valueController instanceof C?new h(t.controller):null};class X extends B{constructor(t){super(t),this.value=t.value}}function Y(){return new T({positions:P([],{equals:a})})}class $ extends T{static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=T.createCore(e);return new $(n)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!s(t)?`${t}px`:"auto"}bindExpandedClass(t,e){b(this,"expanded",(()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)}))}constructor(t){super(t)}}function Q(t,e){e.style.height=t.styleHeight}function Z(t,e){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),s(t.get("expandedHeight"))&&t.set("expandedHeight",function(t,e){let n=0;return function(t,e){const n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),L(e),n=e.clientHeight,t.set("temporaryExpanded",null),L(e)})),n}(t,e)),t.set("shouldFixHeight",!0),L(e)})),t.emitter.on("change",(()=>{Q(t,e)})),Q(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&(t.set("shouldFixHeight",!1),t.set("expandedHeight",null),t.set("completed",!0))}))}class J extends e{constructor(t,e){super(t),this.rackApi_=e}}class tt{get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw u.shouldNeverHappen();const n=void 0!==e?e:this.items_.length;this.items_.splice(n,0,t),this.cache_.add(t);const r=this.extract_(t);r&&(r.emitter.on("add",this.onSubListAdd_),r.emitter.on("remove",this.onSubListRemove_),r.allItems().forEach((t=>{this.cache_.add(t)}))),this.emitter.emit("add",{index:n,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const n=this.extract_(t);n&&(n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}constructor(t){this.emitter=new d,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}}class et extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingChange_(t){const e=t.sender.target.read();this.emitter_.emit("change",{event:new r(this,e,this.controller_.binding.target.presetKey,t.options.last)})}constructor(t){super(t),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new d,this.controller_.binding.emitter.on("change",this.onBindingChange_)}}class nt extends W{constructor(t,e){super(t,e),this.binding=e.binding}}class rt extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(t){const e=t.sender.target.read();this.emitter_.emit("update",{event:new i(this,e,this.controller_.binding.target.presetKey)})}constructor(t){super(t),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new d,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}}class it extends W{constructor(t,e){super(t,e),this.binding=e.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose((()=>{this.binding.dispose()}))}}function ot(t){return t instanceof lt?t.apiSet_:t instanceof J?t.rackApi_.apiSet_:null}function st(t,e){const n=t.find((t=>t.controller_===e));if(!n)throw u.shouldNeverHappen();return n}function at(t,e,n){if(!c.isBindable(t))throw u.notBindable();return new c(t,e,n)}class lt extends e{get children(){return this.controller_.rack.children.map((t=>st(this.apiSet_,t)))}addInput(t,e,n){const r=n||{},i=this.controller_.view.element.ownerDocument,o=this.pool_.createInput(i,at(t,e,r.presetKey),r),s=new et(o);return this.add(s,r.index)}addMonitor(t,e,n){const r=n||{},i=this.controller_.view.element.ownerDocument,o=this.pool_.createMonitor(i,at(t,e),r),s=new rt(o);return this.add(s,r.index)}addFolder(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}(this,t)}addButton(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}(this,t)}addSeparator(t){return function(t,e){const n=e||{};return t.addBlade(Object.assign(Object.assign({},n),{view:"separator"}))}(this,t)}addTab(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}(this,t)}add(t,e){this.controller_.rack.add(t.controller_,e);const n=this.apiSet_.find((e=>e.controller_===t.controller_));return n&&this.apiSet_.remove(n),this.apiSet_.add(t),t}remove(t){this.controller_.rack.remove(t.controller_)}addBlade(t){const e=this.controller_.view.element.ownerDocument,n=this.pool_.createBlade(e,t),r=this.pool_.createBladeApi(n);return this.add(r,t.index)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}setUpApi_(t){this.apiSet_.find((e=>e.controller_===t))||this.apiSet_.add(this.pool_.createBladeApi(t))}onRackAdd_(t){this.setUpApi_(t.bladeController)}onRackRemove_(t){if(t.isRoot){const e=st(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}onRackInputChange_(t){const e=t.bladeController;if(e instanceof nt){const n=st(this.apiSet_,e),i=e.binding;this.emitter_.emit("change",{event:new r(n,i.target.read(),i.target.presetKey,t.options.last)})}else if(e instanceof X){const n=st(this.apiSet_,e);this.emitter_.emit("change",{event:new r(n,e.value.rawValue,void 0,t.options.last)})}}onRackMonitorUpdate_(t){if(!(t.bladeController instanceof it))throw u.shouldNeverHappen();const e=st(this.apiSet_,t.bladeController),n=t.bladeController.binding;this.emitter_.emit("update",{event:new i(e,n.target.read(),n.target.presetKey)})}constructor(t,e){super(t),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new d,this.apiSet_=new tt(ot),this.pool_=e;const n=this.controller_.rack;n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),n.emitter.on("inputchange",this.onRackInputChange_),n.emitter.on("monitorupdate",this.onRackMonitorUpdate_),n.children.forEach((t=>{this.setUpApi_(t)}))}}class ut extends J{get expanded(){return this.controller_.foldable.get("expanded")}set expanded(t){this.controller_.foldable.set("expanded",t)}get title(){return this.controller_.props.get("title")}set title(t){this.controller_.props.set("title",t)}get children(){return this.rackApi_.children}addInput(t,e,n){return this.rackApi_.addInput(t,e,n)}addMonitor(t,e,n){return this.rackApi_.addMonitor(t,e,n)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}constructor(t,e){super(t,new lt(t.rackController,e)),this.emitter_=new d,this.controller_.foldable.value("expanded").emitter.on("change",(t=>{this.emitter_.emit("fold",{event:new o(this,t.sender.rawValue)})})),this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})}))}}class ct extends B{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}}class ht{constructor(t,e){const n=v(e.viewName);this.element=t.createElement("div"),this.element.classList.add(n()),e.viewProps.bindClassModifiers(this.element)}}function dt(t){return t instanceof ft?t.rack:t instanceof ct?t.rackController.rack:null}function pt(t){const e=dt(t);return e?e.bcSet_:null}class vt{get children(){return this.bcSet_.items}add(t,e){t.parent&&t.parent.remove(t),t.parent_=this,this.bcSet_.add(t,e)}remove(t){t.parent_=null,this.bcSet_.remove(t)}find(t){return this.bcSet_.allItems().filter((e=>e instanceof t))}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),!e)return;const n=t.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),n instanceof nt)n.binding.emitter.on("change",this.onChildInputChange_);else if(n instanceof it)n.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(n instanceof X)n.value.emitter.on("change",this.onChildValueChange_);else{const t=dt(n);if(t){const e=t.emitter;e.on("layout",this.onDescendantLayout_),e.on("inputchange",this.onDescendantInputChange_),e.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),!e)return;const n=t.item;if(n instanceof nt)n.binding.emitter.off("change",this.onChildInputChange_);else if(n instanceof it)n.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(n instanceof X)n.value.emitter.off("change",this.onChildValueChange_);else{const t=dt(n);if(t){const e=t.emitter;e.off("layout",this.onDescendantLayout_),e.off("inputchange",this.onDescendantInputChange_),e.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const t=this.bcSet_.items.filter((t=>!t.viewProps.get("hidden"))),e=t[0],n=t[t.length-1];this.bcSet_.items.forEach((t=>{const r=[];t===e&&(r.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||r.push("veryfirst")),t===n&&(r.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||r.push("verylast")),t.blade.set("positions",r)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((t=>t.viewProps.get("disposed"))).forEach((t=>{this.bcSet_.remove(t)}))}onChildInputChange_(t){const e=function(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(r instanceof nt&&r.binding===e)return r}return null}(this.find(nt),t.sender);if(!e)throw u.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onChildMonitorUpdate_(t){const e=function(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(r instanceof it&&r.binding===e)return r}return null}(this.find(it),t.sender);if(!e)throw u.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}onChildValueChange_(t){const e=function(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(r instanceof X&&r.value===e)return r}return null}(this.find(X),t.sender);if(!e)throw u.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onDescendantLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}onDescendantMonitorUpdate_(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}constructor(t){var e;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new d,this.blade_=null!=t?t:null,null===(e=this.blade_)||void 0===e||e.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new tt(pt),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}}class ft extends B{onRackAdd_(t){t.isRoot&&N(this.view.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.isRoot&&z(t.bladeController.view.element)}constructor(t,e){super(Object.assign(Object.assign({},e),{view:new ht(t,{viewName:"brk",viewProps:e.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const n=new vt(e.root?void 0:e.blade);n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),this.rack=n,this.viewProps.handleDispose((()=>{for(let t=this.rack.children.length-1;t>=0;t--){this.rack.children[t].viewProps.set("disposed",!0)}}))}}const mt=v("cnt");class bt{constructor(t,e){this.className_=v(e.viewName||"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),mt()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),b(this.foldable_,"completed",_(this.element,this.className_(void 0,"cpl")));const n=t.createElement("button");n.classList.add(this.className_("b")),b(e.props,"title",(t=>{s(t)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const r=t.createElement("div");r.classList.add(this.className_("t")),g(e.props.value("title"),r),this.buttonElement.appendChild(r),this.titleElement=r;const i=t.createElement("div");i.classList.add(this.className_("m")),this.buttonElement.appendChild(i);const o=e.containerElement;o.classList.add(this.className_("c")),this.element.appendChild(o),this.containerElement=o}}class _t extends ct{get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}constructor(t,e){var n;const r=$.create(null===(n=e.expanded)||void 0===n||n),i=new ft(t,{blade:e.blade,root:e.root,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:i,view:new bt(t,{containerElement:i.view.element,foldable:r,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=r,Z(this.foldable,this.view.containerElement),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}}const gt={id:"folder",type:"blade",accept(t){const e=A,n=S(t,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return n?{params:n}:null},controller:t=>new _t(t.document,{blade:t.blade,expanded:t.params.expanded,props:T.fromObject({title:t.params.title}),viewProps:t.viewProps}),api:t=>t.controller instanceof _t?new ut(t.controller,t.pool):null};class wt extends X{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new G(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class xt extends e{}const Ct=v("spr");class Et{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ct()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("hr");n.classList.add(Ct("r")),this.element.appendChild(n)}}class yt extends B{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Et(t,{viewProps:e.viewProps})}))}}const Pt={id:"separator",type:"blade",accept(t){const e=S(t,{view:A.required.constant("separator")});return e?{params:e}:null},controller:t=>new yt(t.document,{blade:t.blade,viewProps:t.viewProps}),api:t=>t.controller instanceof yt?new xt(t.controller):null},Tt=v("");function Mt(t,e){return _(t,Tt(void 0,e))}class kt extends T{static create(t){var e,n;const r=null!=t?t:{},i={disabled:null!==(e=r.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(n=r.hidden)&&void 0!==n&&n},o=T.createCore(i);return new kt(o)}bindClassModifiers(t){b(this,"disabled",Mt(t,"disabled")),b(this,"hidden",Mt(t,"hidden"))}bindDisabled(t){b(this,"disabled",(e=>{t.disabled=e}))}bindTabIndex(t){b(this,"disabled",(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}constructor(t){super(t)}}const At=v("tbi");class St{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(At()),e.viewProps.bindClassModifiers(this.element),b(e.props,"selected",(t=>{t?this.element.classList.add(At(void 0,"sel")):this.element.classList.remove(At(void 0,"sel"))}));const n=t.createElement("button");n.classList.add(At("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const r=t.createElement("div");r.classList.add(At("t")),g(e.props.value("title"),r),this.buttonElement.appendChild(r),this.titleElement=r}}class Ft{onClick_(){this.emitter.emit("click",{sender:this})}constructor(t,e){this.emitter=new d,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new St(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}}class Rt{get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}constructor(t,e){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Ft(t,{props:e.itemProps,viewProps:kt.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new ft(t,{blade:Y(),viewProps:kt.create()}),this.props=e.props,b(this.props,"selected",(t=>{this.itemController.props.set("selected",t),this.contentController.viewProps.set("hidden",!t)}))}}class Bt{get title(){var t;return null!==(t=this.controller_.itemController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.itemController.props.set("title",t)}get selected(){return this.controller_.props.get("selected")}set selected(t){this.controller_.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addInput(t,e,n){return this.rackApi_.addInput(t,e,n)}addMonitor(t,e,n){return this.rackApi_.addMonitor(t,e,n)}addBlade(t){return this.rackApi_.addBlade(t)}constructor(t,e){this.controller_=t,this.rackApi_=e}}class Vt extends J{get pages(){return this.controller_.pageSet.items.map((t=>{const e=this.pageApiMap_.get(t);if(!e)throw u.shouldNeverHappen();return e}))}addPage(t){const e=this.controller_.view.element.ownerDocument,n=new Rt(e,{itemProps:T.fromObject({selected:!1,title:t.title}),props:T.fromObject({selected:!1})});this.controller_.add(n,t.index);const r=this.pageApiMap_.get(n);if(!r)throw u.shouldNeverHappen();return r}removePage(t){this.controller_.remove(t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}setUpPageApi_(t){const e=this.rackApi_.apiSet_.find((e=>e.controller_===t.contentController));if(!e)throw u.shouldNeverHappen();const n=new Bt(t,e);this.pageApiMap_.set(t,n)}onPageAdd_(t){this.setUpPageApi_(t.item)}onPageRemove_(t){if(!this.pageApiMap_.get(t.item))throw u.shouldNeverHappen();this.pageApiMap_.delete(t.item)}constructor(t,e){super(t,new lt(t.rackController,e)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.emitter_=new d,this.pageApiMap_=new Map,this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})})),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach((t=>{this.setUpPageApi_(t)}))}}const Lt=v("tab");class Dt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Lt(),mt()),e.viewProps.bindClassModifiers(this.element),m(e.empty,_(this.element,Lt(void 0,"nop")));const n=t.createElement("div");n.classList.add(Lt("i")),this.element.appendChild(n),this.itemsElement=n;const r=e.contentsElement;r.classList.add(Lt("c")),this.element.appendChild(r),this.contentsElement=r}}class Ut extends ct{get pageSet(){return this.pageSet_}add(t,e){this.pageSet_.add(t,null!=e?e:this.pageSet_.items.length)}remove(t){this.pageSet_.remove(this.pageSet_.items[t])}applyPages_(){this.keepSelection_(),this.empty_.rawValue=0===this.pageSet_.items.length}onPageAdd_(t){const e=t.item;N(this.view.itemsElement,e.itemController.view.element,t.index),this.rackController.rack.add(e.contentController,t.index),e.props.value("selected").emitter.on("change",this.onPageSelectedChange_),this.applyPages_()}onPageRemove_(t){const e=t.item;z(e.itemController.view.element),this.rackController.rack.remove(e.contentController),e.props.value("selected").emitter.off("change",this.onPageSelectedChange_),this.applyPages_()}keepSelection_(){if(0===this.pageSet_.items.length)return;const t=this.pageSet_.items.findIndex((t=>t.props.get("selected")));t<0?this.pageSet_.items.forEach(((t,e)=>{t.props.set("selected",0===e)})):this.pageSet_.items.forEach(((e,n)=>{e.props.set("selected",n===t)}))}onPageSelectedChange_(t){if(t.rawValue){const e=this.pageSet_.items.findIndex((e=>e.props.value("selected")===t.sender));this.pageSet_.items.forEach(((t,n)=>{t.props.set("selected",n===e)}))}else this.keepSelection_()}constructor(t,e){const n=new ft(t,{blade:e.blade,viewProps:e.viewProps}),r=P(!0);super({blade:e.blade,rackController:n,view:new Dt(t,{contentsElement:n.view.element,empty:r,viewProps:e.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onPageSelectedChange_=this.onPageSelectedChange_.bind(this),this.pageSet_=new tt((()=>null)),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.empty_=r,this.applyPages_()}}const It={id:"tab",type:"blade",accept(t){const e=A,n=S(t,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return n&&0!==n.pages.length?{params:n}:null},controller(t){const e=new Ut(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach((n=>{const r=new Rt(t.document,{itemProps:T.fromObject({selected:!1,title:n.title}),props:T.fromObject({selected:!1})});e.add(r)})),e},api:t=>t.controller instanceof Ut?new Vt(t.controller,t.pool):null};class Ot{dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}constructor(){this.disabled=!1,this.emitter=new d}}class Nt{get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new d,this.interval_=e,this.setTimer_()}}class zt{constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}constructor(t){this.constraints=t}}function jt(t,e){if(t instanceof e)return t;if(t instanceof zt){const n=t.constraints.reduce(((t,n)=>t||(n instanceof e?n:null)),null);if(n)return n}return null}class Ht{constrain(t){const e=this.options;if(0===e.length)return t;return e.filter((e=>e.value===t)).length>0?t:e[0].value}constructor(t){this.options=t}}class Kt{constrain(t){let e=t;return s(this.minValue)||(e=Math.max(e,this.minValue)),s(this.maxValue)||(e=Math.min(e,this.maxValue)),e}constructor(t){this.maxValue=t.max,this.minValue=t.min}}class Gt{constrain(t){return(t<0?-Math.round(-t/this.step):Math.round(t/this.step))*this.step}constructor(t){this.step=t}}const Wt=v("lst");class qt{update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(Wt()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("select");n.classList.add(Wt("s")),b(this.props_,"options",(e=>{j(n),e.forEach(((e,r)=>{const i=t.createElement("option");i.dataset.index=String(r),i.textContent=e.text,i.value=String(e.value),n.appendChild(i)}))})),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.selectElement=n;const r=t.createElement("div");r.classList.add(Wt("m")),r.appendChild(O(t,"dropdown")),this.element.appendChild(r),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,this.update_()}}class Xt{onSelectChange_(t){const e=t.currentTarget.selectedOptions.item(0);if(!e)return;const n=Number(e.dataset.index);this.value.rawValue=this.props.get("options")[n].value}constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new qt(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}}const Yt=v("pop");class $t{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Yt()),e.viewProps.bindClassModifiers(this.element),m(e.shows,_(this.element,Yt(void 0,"v")))}}class Qt{constructor(t,e){this.shows=P(!1),this.viewProps=e.viewProps,this.view=new $t(t,{shows:this.shows,viewProps:this.viewProps})}}const Zt=v("txt");class Jt{refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Zt()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const n=t.createElement("input");n.classList.add(Zt("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}}class te{onInputChange_(t){const e=t.currentTarget.value,n=this.parser_(e);s(n)||(this.value.rawValue=n),this.view.refresh()}constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Jt(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}}function ee(t){return"false"!==t&&!!t}function ne(t){return function(t){return String(t)}(t)}class re{evaluate(){return Number(this.text)}toString(){return this.text}constructor(t){this.text=t}}const ie={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class oe{evaluate(){const t=ie[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}constructor(t,e,n){this.left=e,this.operator=t,this.right=n}}const se={"+":t=>t,"-":t=>-t,"~":t=>~t};class ae{evaluate(){const t=se[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}constructor(t,e){this.operator=t,this.expression=e}}function le(t){return(e,n)=>{for(let r=0;r<t.length;r++){const i=t[r](e,n);if(""!==i)return i}return""}}function ue(t,e){var n;const r=t.substr(e).match(/^\s+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}function ce(t,e){var n;const r=t.substr(e).match(/^[0-9]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}function he(t,e){const n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";const r=function(t,e){const n=ce(t,e);if(""!==n)return n;const r=t.substr(e,1);if("-"!==r&&"+"!==r)return"";const i=ce(t,e+=1);return""===i?"":r+i}(t,e);return""===r?"":n+r}function de(t,e){const n=t.substr(e,1);if("0"===n)return n;const r=function(t,e){const n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}(t,e);return e+=r.length,""===r?"":r+ce(t,e)}const pe=le([function(t,e){const n=de(t,e);if(e+=n.length,""===n)return"";const r=t.substr(e,1);if(e+=r.length,"."!==r)return"";const i=ce(t,e);return n+r+i+he(t,e+=i.length)},function(t,e){const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const r=ce(t,e);return e+=r.length,""===r?"":n+r+he(t,e)},function(t,e){const n=de(t,e);return e+=n.length,""===n?"":n+he(t,e)}]);const ve=le([function(t,e){const n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";const r=function(t,e){var n;const r=t.substr(e).match(/^[01]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}(t,e);return""===r?"":n+r},function(t,e){const n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";const r=function(t,e){var n;const r=t.substr(e).match(/^[0-7]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}(t,e);return""===r?"":n+r},function(t,e){const n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";const r=function(t,e){var n;const r=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=r&&r[0])&&void 0!==n?n:""}(t,e);return""===r?"":n+r}]),fe=le([ve,pe]);function me(t,e){return function(t,e){const n=fe(t,e);return e+=n.length,""===n?null:{evaluable:new re(n),cursor:e}}(t,e)||function(t,e){const n=t.substr(e,1);if(e+=n.length,"("!==n)return null;const r=ge(t,e);if(!r)return null;e=r.cursor,e+=ue(t,e).length;const i=t.substr(e,1);return e+=i.length,")"!==i?null:{evaluable:r.evaluable,cursor:e}}(t,e)}function be(t,e,n){n+=ue(e,n).length;const r=t.filter((t=>e.startsWith(t,n)))[0];return r?(n+=r.length,{cursor:n+=ue(e,n).length,operator:r}):null}const _e=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>function(t,e){return(n,r)=>{const i=t(n,r);if(!i)return null;r=i.cursor;let o=i.evaluable;for(;;){const i=be(e,n,r);if(!i)break;r=i.cursor;const s=t(n,r);if(!s)return null;r=s.cursor,o=new oe(i.operator,o,s.evaluable)}return o?{cursor:r,evaluable:o}:null}}(t,e)),(function t(e,n){const r=me(e,n);if(r)return r;const i=e.substr(n,1);if(n+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;const o=t(e,n);return o?{cursor:n=o.cursor,evaluable:new ae(i,o.evaluable)}:null}));function ge(t,e){return e+=ue(t,e).length,_e(t,e)}function we(t){var e;const n=function(t){const e=ge(t,0);return e?e.cursor+ue(t,e.cursor).length!==t.length?null:e.evaluable:null}(t);return null!==(e=null==n?void 0:n.evaluate())&&void 0!==e?e:null}function xe(t){if("number"==typeof t)return t;if("string"==typeof t){const e=we(t);if(!s(e))return e}return 0}function Ce(t){return String(t)}function Ee(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}const ye=Ee(0);function Pe(t){return ye(t)+"%"}function Te(t){return String(t)}function Me(t){return t}function ke(t,e){for(;t.length<e;)t.push(void 0)}function Ae(t){const e=[];return ke(e,t),P(e)}function Se(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}function Fe({primary:t,secondary:e,forward:n,backward:r}){let i=!1;function o(t){i||(i=!0,t(),i=!1)}t.emitter.on("change",(r=>{o((()=>{e.setRawValue(n(t,e),r.options)}))})),e.emitter.on("change",(i=>{o((()=>{t.setRawValue(r(t,e),i.options)})),o((()=>{e.setRawValue(n(t,e),i.options)}))})),o((()=>{e.setRawValue(n(t,e),{forceEmit:!1,last:!0})}))}function Re(t,e){const n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function Be(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function Ve(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function Le(t){return function(t){return"ArrowUp"===t||"ArrowDown"===t}(t)||"ArrowLeft"===t||"ArrowRight"===t}function De(t,e){const n=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:t.pageX-((n&&n.scrollX||0)+r.left),y:t.pageY-((n&&n.scrollY||0)+r.top)}}class Ue{computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(De(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(De(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(De(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,r=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-r.left,y:n.clientY-r.top}:void 0),sender:this,shiftKey:t.shiftKey})}constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new d,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}}function Ie(t,e,n,r,i){return r+(t-e)/(n-e)*(i-r)}function Oe(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Ne(t,e,n){return Math.min(Math.max(t,e),n)}function ze(t,e){return(t%e+e)%e}const je=v("txt");class He{onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(je(void 0,"drg"));this.element.classList.add(je(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),r=Ne(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+r},0 L${n},4 L${n+r},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const i=this.props_.get("formatter");this.tooltipElem_.textContent=i(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(je(),je(void 0,"num")),e.arrayPosition&&this.element.classList.add(je(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(je("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(je()),this.inputElement.classList.add(je("i"));const r=t.createElement("div");r.classList.add(je("k")),this.element.appendChild(r),this.knobElement=r;const i=t.createElementNS(V,"svg");i.classList.add(je("g")),this.knobElement.appendChild(i);const o=t.createElementNS(V,"path");o.classList.add(je("gb")),i.appendChild(o),this.guideBodyElem_=o;const s=t.createElementNS(V,"path");s.classList.add(je("gh")),i.appendChild(s),this.guideHeadElem_=s;const a=t.createElement("div");a.classList.add(v("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}}class Ke{onInputChange_(t){const e=t.currentTarget.value,n=this.parser_(e);s(n)||(this.value.rawValue=n),this.view.refresh()}onInputKeyDown_(t){const e=Re(this.baseStep_,Be(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==Re(this.baseStep_,Be(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.originRawValue_+e*this.props.get("draggingScale")}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}constructor(t,e){this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=P(null),this.view=new He(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const n=new Ue(this.view.knobElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}}const Ge=v("sld");class We{update_(){const t=Ne(Ie(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Ge()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(Ge("t")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;const r=t.createElement("div");r.classList.add(Ge("k")),this.trackElement.appendChild(r),this.knobElement=r,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}}class qe{handlePointerEvent_(t,e){t.point&&this.value.setRawValue(Ie(Ne(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Re(this.baseStep_,Ve(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Re(this.baseStep_,Ve(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new We(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ue(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}}const Xe=v("sldtxt");class Ye{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Xe());const n=t.createElement("div");n.classList.add(Xe("s")),this.sliderView_=e.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);const r=t.createElement("div");r.classList.add(Xe("t")),this.textView_=e.textView,r.appendChild(this.textView_.element),this.element.appendChild(r)}}class $e{get sliderController(){return this.sliderC_}get textController(){return this.textC_}constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new qe(t,{baseStep:e.baseStep,props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new Ke(t,{baseStep:e.baseStep,parser:e.parser,props:e.textProps,value:e.value,viewProps:e.viewProps}),this.view=new Ye(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}}function Qe(t,e){t.write(e)}function Ze(t){const e=A;return Array.isArray(t)?e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(t).value:"object"==typeof t?e.required.raw(t).value:void 0}function Je(t){if("inline"===t||"popup"===t)return t}function tn(t){const e=A;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}function en(t){if(Array.isArray(t))return t;const e=[];return Object.keys(t).forEach((n=>{e.push({text:n,value:t[n]})})),e}function nn(t){return s(t)?null:new Ht(en(t))}function rn(t){const e=t?jt(t,Ht):null;return e?e.options:null}function on(t,e){const n=t&&jt(t,Gt);return n?Oe(n.step):Math.max(Oe(e),2)}function sn(t){const e=function(t){const e=t?jt(t,Gt):null;return e?e.step:null}(t);return null!=e?e:1}function an(t,e){var n;const r=t&&jt(t,Gt),i=Math.abs(null!==(n=null==r?void 0:r.step)&&void 0!==n?n:e);return 0===i?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}const ln=v("ckb");class un{update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ln()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("label");n.classList.add(ln("l")),this.element.appendChild(n);const r=t.createElement("input");r.classList.add(ln("i")),r.type="checkbox",n.appendChild(r),this.inputElement=r,e.viewProps.bindDisabled(this.inputElement);const i=t.createElement("div");i.classList.add(ln("w")),n.appendChild(i);const o=O(t,"check");i.appendChild(o),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}}class cn{onInputChange_(t){const e=t.currentTarget;this.value.rawValue=e.checked}constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new un(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}}const hn={id:"input-bool",type:"input",accept:(t,e)=>{if("boolean"!=typeof t)return null;const n=S(e,{options:A.optional.custom(Ze)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>ee,constraint:t=>function(t){const e=[],n=nn(t.options);return n&&e.push(n),new zt(e)}(t.params),writer:t=>Qe},controller:t=>{var e;const n=t.document,r=t.value,i=t.constraint;return i&&jt(i,Ht)?new Xt(n,{props:T.fromObject({options:null!==(e=rn(i))&&void 0!==e?e:[]}),value:r,viewProps:t.viewProps}):new cn(n,{value:r,viewProps:t.viewProps})}},dn=v("col");class pn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(dn()),e.foldable.bindExpandedClass(this.element,dn(void 0,"expanded")),b(e.foldable,"completed",_(this.element,dn(void 0,"cpl")));const n=t.createElement("div");n.classList.add(dn("h")),this.element.appendChild(n);const r=t.createElement("div");r.classList.add(dn("s")),n.appendChild(r),this.swatchElement=r;const i=t.createElement("div");if(i.classList.add(dn("t")),n.appendChild(i),this.textElement=i,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(dn("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}function vn(t,e,n){const r=ze(t,360),i=Ne(e/100,0,1),o=Ne(n/100,0,1),s=o*i,a=s*(1-Math.abs(r/60%2-1)),l=o-s;let u,c,h;return[u,c,h]=r>=0&&r<60?[s,a,0]:r>=60&&r<120?[a,s,0]:r>=120&&r<180?[0,s,a]:r>=180&&r<240?[0,a,s]:r>=240&&r<300?[a,0,s]:[s,0,a],[255*(u+l),255*(c+l),255*(h+l)]}function fn(t){return[t[0],t[1],t[2]]}function mn(t,e){return[t[0],t[1],t[2],e]}const bn={hsl:{hsl:(t,e,n)=>[t,e,n],hsv:function(t,e,n){const r=n+e*(100-Math.abs(2*n-100))/200;return[t,0!==r?e*(100-Math.abs(2*n-100))/r:0,n+e*(100-Math.abs(2*n-100))/200]},rgb:function(t,e,n){const r=(t%360+360)%360,i=Ne(e/100,0,1),o=Ne(n/100,0,1),s=(1-Math.abs(2*o-1))*i,a=s*(1-Math.abs(r/60%2-1)),l=o-s/2;let u,c,h;return[u,c,h]=r>=0&&r<60?[s,a,0]:r>=60&&r<120?[a,s,0]:r>=120&&r<180?[0,s,a]:r>=180&&r<240?[0,a,s]:r>=240&&r<300?[a,0,s]:[s,0,a],[255*(u+l),255*(c+l),255*(h+l)]}},hsv:{hsl:function(t,e,n){const r=100-Math.abs(n*(200-e)/100-100);return[t,0!==r?e*n/r:0,n*(200-e)/200]},hsv:(t,e,n)=>[t,e,n],rgb:vn},rgb:{hsl:function(t,e,n){const r=Ne(t/255,0,1),i=Ne(e/255,0,1),o=Ne(n/255,0,1),s=Math.max(r,i,o),a=Math.min(r,i,o),l=s-a;let u=0,c=0;const h=(a+s)/2;return 0!==l&&(c=l/(1-Math.abs(s+a-1)),u=r===s?(i-o)/l:i===s?2+(o-r)/l:4+(r-i)/l,u=u/6+(u<0?1:0)),[360*u,100*c,100*h]},hsv:function(t,e,n){const r=Ne(t/255,0,1),i=Ne(e/255,0,1),o=Ne(n/255,0,1),s=Math.max(r,i,o),a=s-Math.min(r,i,o);let l;return l=0===a?0:s===r?((i-o)/a%6+6)%6*60:s===i?60*((o-r)/a+2):60*((r-i)/a+4),[l,100*(0===s?0:a/s),100*s]},rgb:(t,e,n)=>[t,e,n]}};const _n={hsl:t=>{var e;return[ze(t[0],360),Ne(t[1],0,100),Ne(t[2],0,100),Ne(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},hsv:t=>{var e;return[ze(t[0],360),Ne(t[1],0,100),Ne(t[2],0,100),Ne(null!==(e=t[3])&&void 0!==e?e:1,0,1)]},rgb:t=>{var e;return[Ne(t[0],0,255),Ne(t[1],0,255),Ne(t[2],0,255),Ne(null!==(e=t[3])&&void 0!==e?e:1,0,1)]}};function gn(t,e){return"object"==typeof t&&!s(t)&&(e in t&&"number"==typeof t[e])}class wn{static black(){return new wn([0,0,0],"rgb")}static fromObject(t){const e="a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b];return new wn(e,"rgb")}static toRgbaObject(t){return t.toRgbaObject()}static isRgbColorObject(t){return gn(t,"r")&&gn(t,"g")&&gn(t,"b")}static isRgbaColorObject(t){return this.isRgbColorObject(t)&&gn(t,"a")}static isColorObject(t){return this.isRgbColorObject(t)}static equals(t,e){if(t.mode_!==e.mode_)return!1;const n=t.comps_,r=e.comps_;for(let t=0;t<n.length;t++)if(n[t]!==r[t])return!1;return!0}get mode(){return this.mode_}getComponents(t){return mn((e=fn(this.comps_),n=this.mode_,r=t||this.mode_,bn[n][r](...e)),this.comps_[3]);var e,n,r}toRgbaObject(){const t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}}constructor(t,e){this.mode_=e,this.comps_=_n[e](t)}}const xn=v("colp");class Cn{get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map((t=>t.inputElement))];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(xn());const n=t.createElement("div");n.classList.add(xn("hsv"));const r=t.createElement("div");r.classList.add(xn("sv")),this.svPaletteView_=e.svPaletteView,r.appendChild(this.svPaletteView_.element),n.appendChild(r);const i=t.createElement("div");i.classList.add(xn("h")),this.hPaletteView_=e.hPaletteView,i.appendChild(this.hPaletteView_.element),n.appendChild(i),this.element.appendChild(n);const o=t.createElement("div");if(o.classList.add(xn("rgb")),this.textView_=e.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const n=t.createElement("div");n.classList.add(xn("a"));const r=t.createElement("div");r.classList.add(xn("ap")),r.appendChild(this.alphaViews_.palette.element),n.appendChild(r);const i=t.createElement("div");i.classList.add(xn("at")),i.appendChild(this.alphaViews_.text.element),n.appendChild(i),this.element.appendChild(n)}}}function En(t){const e=A;return S(t,{alpha:e.optional.boolean,expanded:e.optional.boolean,picker:e.optional.custom(Je)})}function yn(t){return t?.1:1}function Pn(t,e){const n=t.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*e,e):Math.min(parseFloat(t),e)}const Tn={deg:t=>t,grad:t=>360*t/400,rad:t=>360*t/(2*Math.PI),turn:t=>360*t};function Mn(t){const e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);const n=parseFloat(e[1]),r=e[2];return Tn[r](n)}const kn={"func.rgb":t=>{const e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Pn(e[1],255),Pn(e[2],255),Pn(e[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new wn(n,"rgb")},"func.rgba":t=>{const e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Pn(e[1],255),Pn(e[2],255),Pn(e[3],255),Pn(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new wn(n,"rgb")},"func.hsl":t=>{const e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Mn(e[1]),Pn(e[2],100),Pn(e[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:new wn(n,"hsl")},"func.hsla":t=>{const e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Mn(e[1]),Pn(e[2],100),Pn(e[3],100),Pn(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:new wn(n,"hsl")},"hex.rgb":t=>{const e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new wn([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)],"rgb");const n=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new wn([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)],"rgb"):null},"hex.rgba":t=>{const e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return new wn([parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Ie(parseInt(e[4]+e[4],16),0,255,0,1)],"rgb");const n=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?new wn([parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Ie(parseInt(n[4],16),0,255,0,1)],"rgb"):null}};function An(t){return Object.keys(kn).reduce(((e,n)=>{if(e)return e;return(0,kn[n])(t)?n:null}),null)}const Sn=t=>{const e=An(t);return e?kn[e](t):null};function Fn(t){return"func.hsla"===t||"func.rgba"===t||"hex.rgba"===t}function Rn(t){if("string"==typeof t){const e=Sn(t);if(e)return e}return wn.black()}function Bn(t){const e=Ne(Math.floor(t),0,255).toString(16);return 1===e.length?`0${e}`:e}function Vn(t,e="#"){return`${e}${fn(t.getComponents("rgb")).map(Bn).join("")}`}function Ln(t,e="#"){const n=t.getComponents("rgb");return`${e}${[n[0],n[1],n[2],255*n[3]].map(Bn).join("")}`}function Dn(t){const e=Ee(0);return`rgb(${fn(t.getComponents("rgb")).map((t=>e(t))).join(", ")})`}function Un(t){const e=Ee(2),n=Ee(0);return`rgba(${t.getComponents("rgb").map(((t,r)=>(3===r?e:n)(t))).join(", ")})`}const In={"func.hsl":function(t){const e=[Ee(0),Pe,Pe];return`hsl(${fn(t.getComponents("hsl")).map(((t,n)=>e[n](t))).join(", ")})`},"func.hsla":function(t){const e=[Ee(0),Pe,Pe,Ee(2)];return`hsla(${t.getComponents("hsl").map(((t,n)=>e[n](t))).join(", ")})`},"func.rgb":Dn,"func.rgba":Un,"hex.rgb":Vn,"hex.rgba":Ln};function On(t){return In[t]}const Nn=v("apl");class zn{update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),n=new wn([e[0],e[1],e[2],0],"rgb"),r=new wn([e[0],e[1],e[2],255],"rgb"),i=["to right",Un(n),Un(r)];this.colorElem_.style.background=`linear-gradient(${i.join(",")})`,this.previewElem_.style.backgroundColor=Un(t);const o=Ie(e[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Nn()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add(Nn("b")),this.element.appendChild(n);const r=t.createElement("div");r.classList.add(Nn("c")),n.appendChild(r),this.colorElem_=r;const i=t.createElement("div");i.classList.add(Nn("m")),this.element.appendChild(i),this.markerElem_=i;const o=t.createElement("div");o.classList.add(Nn("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}}class jn{handlePointerEvent_(t,e){if(!t.point)return;const n=t.point.x/t.bounds.width,r=this.value.rawValue,[i,o,s]=r.getComponents("hsv");this.value.setRawValue(new wn([i,o,s,n],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Re(yn(!0),Ve(t));if(0===e)return;const n=this.value.rawValue,[r,i,o,s]=n.getComponents("hsv");this.value.setRawValue(new wn([r,i,o,s+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Re(yn(!0),Ve(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new zn(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ue(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}}const Hn=v("coltxt");class Kn{get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(t){this.textViews_=t,this.applyTextViews_()}applyTextViews_(){j(this.textsElem_);const t=this.element.ownerDocument;this.textViews_.forEach((e=>{const n=t.createElement("div");n.classList.add(Hn("c")),n.appendChild(e.element),this.textsElem_.appendChild(n)}))}constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Hn());const n=t.createElement("div");n.classList.add(Hn("m")),this.modeElem_=function(t){const e=t.createElement("select");return e.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}].reduce(((e,n)=>{const r=t.createElement("option");return r.textContent=n.text,r.value=n.value,e.appendChild(r),e}),t.createDocumentFragment())),e}(t),this.modeElem_.classList.add(Hn("ms")),n.appendChild(this.modeSelectElement);const r=t.createElement("div");r.classList.add(Hn("mm")),r.appendChild(O(t,"dropdown")),n.appendChild(r),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(Hn("w")),this.element.appendChild(i),this.textsElem_=i,this.textViews_=e.textViews,this.applyTextViews_(),m(e.colorMode,(t=>{this.modeElem_.value=t}))}}const Gn=Ee(0),Wn={rgb:()=>new Kt({min:0,max:255}),hsl:t=>new Kt(0===t?{min:0,max:360}:{min:0,max:100}),hsv:t=>new Kt(0===t?{min:0,max:360}:{min:0,max:100})};function qn(t,e,n){return new Ke(t,{arrayPosition:0===n?"fst":2===n?"lst":"mid",baseStep:yn(!1),parser:e.parser,props:T.fromObject({draggingScale:1,formatter:Gn}),value:P(0,{constraint:Wn[e.colorMode](n)}),viewProps:e.viewProps})}class Xn{createComponentControllers_(t){const e={colorMode:this.colorMode.rawValue,parser:this.parser_,viewProps:this.viewProps},n=[qn(t,e,0),qn(t,e,1),qn(t,e,2)];return n.forEach(((t,e)=>{Fe({primary:this.value,secondary:t.value,forward:t=>t.rawValue.getComponents(this.colorMode.rawValue)[e],backward:(t,n)=>{const r=this.colorMode.rawValue,i=t.rawValue.getComponents(r);return i[e]=n.rawValue,new wn(mn(fn(i),i[3]),r)}})})),n}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.parser_=e.parser,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=P(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new Kn(t,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}}const Yn=v("hpl");class $n{update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=Dn(new wn([e,100,100],"hsv"));const n=Ie(e,0,360,0,100);this.markerElem_.style.left=`${n}%`}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Yn()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add(Yn("c")),this.element.appendChild(n);const r=t.createElement("div");r.classList.add(Yn("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}}class Qn{handlePointerEvent_(t,e){if(!t.point)return;const n=Ie(t.point.x,0,t.bounds.width,0,360),r=this.value.rawValue,[,i,o,s]=r.getComponents("hsv");this.value.setRawValue(new wn([n,i,o,s],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Re(yn(!1),Ve(t));if(0===e)return;const n=this.value.rawValue,[r,i,o,s]=n.getComponents("hsv");this.value.setRawValue(new wn([r+e,i,o,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Re(yn(!1),Ve(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new $n(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ue(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}}const Zn=v("svp");class Jn{update_(){const t=function(t){const e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d"):null}(this.canvasElement);if(!t)return;const e=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,r=this.canvasElement.height,i=t.getImageData(0,0,n,r),o=i.data;for(let t=0;t<r;t++)for(let i=0;i<n;i++){const s=Ie(i,0,n,0,100),a=Ie(t,0,r,100,0),l=vn(e[0],s,a),u=4*(t*n+i);o[u]=l[0],o[u+1]=l[1],o[u+2]=l[2],o[u+3]=255}t.putImageData(i,0,0);const s=Ie(e[1],0,100,0,100);this.markerElem_.style.left=`${s}%`;const a=Ie(e[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Zn()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("canvas");n.height=64,n.width=64,n.classList.add(Zn("c")),this.element.appendChild(n),this.canvasElement=n;const r=t.createElement("div");r.classList.add(Zn("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}}class tr{handlePointerEvent_(t,e){if(!t.point)return;const n=Ie(t.point.x,0,t.bounds.width,0,100),r=Ie(t.point.y,0,t.bounds.height,100,0),[i,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new wn([i,n,r,o],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){Le(t.key)&&t.preventDefault();const[e,n,r,i]=this.value.rawValue.getComponents("hsv"),o=yn(!1),s=Re(o,Ve(t)),a=Re(o,Be(t));0===s&&0===a||this.value.setRawValue(new wn([e,n+s,r+a,i],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=yn(!1),n=Re(e,Ve(t)),r=Re(e,Be(t));0===n&&0===r||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Jn(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ue(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}}class er{get textController(){return this.textC_}constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new Qn(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new tr(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new jn(t,{value:this.value,viewProps:this.viewProps}),text:new Ke(t,{parser:we,baseStep:.1,props:T.fromObject({draggingScale:.01,formatter:Ee(2)}),value:P(0,{constraint:new Kt({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Fe({primary:this.value,secondary:this.alphaIcs_.text.value,forward:t=>t.rawValue.getComponents()[3],backward:(t,e)=>{const n=t.rawValue.getComponents();return n[3]=e.rawValue,new wn(n,t.rawValue.mode)}}),this.textC_=new Xn(t,{parser:we,value:this.value,viewProps:this.viewProps}),this.view=new Cn(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}}const nr=v("colsw");class rr{update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=Ln(t)}onValueChange_(){this.update_()}constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(nr()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(nr("sw")),this.element.appendChild(n),this.swatchElem_=n;const r=t.createElement("button");r.classList.add(nr("b")),e.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r,this.update_()}}class ir{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new rr(t,{value:this.value,viewProps:this.viewProps})}}class or{get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,n=t.relatedTarget;n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=H(t);n&&e.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!D(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=$.create(e.expanded),this.swatchC_=new ir(t,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new te(t,{parser:e.parser,props:T.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new pn(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new Qt(t,{viewProps:this.viewProps}):null;const r=new er(t,{supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=r,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(r.view.element),Fe({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Z(this.foldable_,this.view.pickerElement))}}function sr(t){return wn.isColorObject(t)?wn.fromObject(t):wn.black()}function ar(t){return fn(t.getComponents("rgb")).reduce(((t,e)=>t<<8|255&Math.floor(e)),0)}function lr(t){return t.getComponents("rgb").reduce(((t,e,n)=>t<<8|255&Math.floor(3===n?255*e:e)),0)>>>0}function ur(t){return"number"!=typeof t?wn.black():new wn([(e=t)>>16&255,e>>8&255,255&e],"rgb");var e}function cr(t){return"number"!=typeof t?wn.black():new wn([(e=t)>>24&255,e>>16&255,e>>8&255,Ie(255&e,0,255,0,1)],"rgb");var e}function hr(t,e){const n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b),t.writeProperty("a",n.a)}function dr(t,e){const n=e.toRgbaObject();t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b)}function pr(t){return"alpha"in t&&!0===t.alpha}function vr(t){return t?t=>Ln(t,"0x"):t=>Vn(t,"0x")}const fr={id:"input-color-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;if(!("view"in e))return null;if("color"!==e.view)return null;const n=En(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>pr(t.params)?cr:ur,equals:wn.equals,writer:t=>function(t){const e=t?lr:ar;return(t,n)=>{Qe(t,e(n))}}(pr(t.params))},controller:t=>{const e=pr(t.params),n="expanded"in t.params?t.params.expanded:void 0,r="picker"in t.params?t.params.picker:void 0;return new or(t.document,{expanded:null!=n&&n,formatter:vr(e),parser:Sn,pickerLayout:null!=r?r:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}};const mr={id:"input-color-object",type:"input",accept:(t,e)=>{if(!wn.isColorObject(t))return null;const n=En(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>sr,equals:wn.equals,writer:t=>{return e=t.initialValue,wn.isRgbaColorObject(e)?hr:dr;var e}},controller:t=>{const e=wn.isRgbaColorObject(t.initialValue),n="expanded"in t.params?t.params.expanded:void 0,r="picker"in t.params?t.params.picker:void 0,i=e?Ln:Vn;return new or(t.document,{expanded:null!=n&&n,formatter:i,parser:Sn,pickerLayout:null!=r?r:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}},br={id:"input-color-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;if("view"in e&&"text"===e.view)return null;if(!An(t))return null;const n=En(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>Rn,equals:wn.equals,writer:t=>{const e=An(t.initialValue);if(!e)throw u.shouldNeverHappen();return function(t){const e=On(t);return(t,n)=>{Qe(t,e(n))}}(e)}},controller:t=>{const e=An(t.initialValue);if(!e)throw u.shouldNeverHappen();const n=On(e),r="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0;return new or(t.document,{expanded:null!=r&&r,formatter:n,parser:Sn,pickerLayout:null!=i?i:"popup",supportsAlpha:Fn(e),value:t.value,viewProps:t.viewProps})}};class _r{constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var n,r;return null!==(r=null===(n=this.components[e])||void 0===n?void 0:n.constrain(t))&&void 0!==r?r:t}));return this.asm_.fromComponents(e)}constructor(t){this.components=t.components,this.asm_=t.assembly}}const gr=v("pndtxt");class wr{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(gr()),this.textViews.forEach((e=>{const n=t.createElement("div");n.classList.add(gr("a")),n.appendChild(e.element),this.element.appendChild(n)}))}}class xr{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((n,r)=>function(t,e,n){return new Ke(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:P(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}(t,e,r))),this.acs_.forEach(((t,n)=>{Fe({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[n],backward:(t,r)=>{const i=e.assembly.toComponents(t.rawValue);return i[n]=r.rawValue,e.assembly.fromComponents(i)}})})),this.view=new wr(t,{textViews:this.acs_.map((t=>t.view))})}}function Cr(t){const e=[],n=function(t){return"step"in t&&!s(t.step)?new Gt(t.step):null}(t);n&&e.push(n);const r=function(t){return"max"in t&&!s(t.max)||"min"in t&&!s(t.min)?new Kt({max:t.max,min:t.min}):null}(t);r&&e.push(r);const i=nn(t.options);return i&&e.push(i),new zt(e)}function Er(t){const[e,n]=function(t){const e=t?jt(t,Kt):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}(t);return[null!=e?e:0,null!=n?n:100]}const yr={id:"input-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;const n=A,r=S(e,{format:n.optional.function,max:n.optional.number,min:n.optional.number,options:n.optional.custom(Ze),step:n.optional.number});return r?{initialValue:t,params:r}:null},binding:{reader:t=>xe,constraint:t=>Cr(t.params),writer:t=>Qe},controller:t=>{var e,n;const r=t.value,i=t.constraint;if(i&&jt(i,Ht))return new Xt(t.document,{props:T.fromObject({options:null!==(e=rn(i))&&void 0!==e?e:[]}),value:r,viewProps:t.viewProps});const o=null!==(n="format"in t.params?t.params.format:void 0)&&void 0!==n?n:Ee(on(i,r.rawValue));if(i&&jt(i,Kt)){const[e,n]=Er(i);return new $e(t.document,{baseStep:sn(i),parser:we,sliderProps:T.fromObject({maxValue:n,minValue:e}),textProps:T.fromObject({draggingScale:an(i,r.rawValue),formatter:o}),value:r,viewProps:t.viewProps})}return new Ke(t.document,{baseStep:sn(i),parser:we,props:T.fromObject({draggingScale:an(i,r.rawValue),formatter:o}),value:r,viewProps:t.viewProps})}};class Pr{getComponents(){return[this.x,this.y]}static isObject(t){if(s(t))return!1;const e=t.x,n=t.y;return"number"==typeof e&&"number"==typeof n}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}constructor(t=0,e=0){this.x=t,this.y=e}}const Tr={toComponents:t=>t.getComponents(),fromComponents:t=>new Pr(...t)},Mr=v("p2d");class kr{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Mr()),e.viewProps.bindClassModifiers(this.element),m(e.expanded,_(this.element,Mr(void 0,"expanded")));const n=t.createElement("div");n.classList.add(Mr("h")),this.element.appendChild(n);const r=t.createElement("button");r.classList.add(Mr("b")),r.appendChild(O(t,"p2dpad")),e.viewProps.bindDisabled(r),n.appendChild(r),this.buttonElement=r;const i=t.createElement("div");if(i.classList.add(Mr("t")),n.appendChild(i),this.textElement=i,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(Mr("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const Ar=v("p2dp");class Sr{get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),n=this.maxValue_,r=Ie(t,-n,+n,0,100),i=Ie(e,-n,+n,0,100),o=this.invertsY_?100-i:i;this.lineElem_.setAttributeNS(null,"x2",`${r}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${r}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(Ar()),"popup"===e.layout&&this.element.classList.add(Ar(void 0,"p"));const n=t.createElement("div");n.classList.add(Ar("p")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const r=t.createElementNS(V,"svg");r.classList.add(Ar("g")),this.padElement.appendChild(r),this.svgElem_=r;const i=t.createElementNS(V,"line");i.classList.add(Ar("ax")),i.setAttributeNS(null,"x1","0"),i.setAttributeNS(null,"y1","50%"),i.setAttributeNS(null,"x2","100%"),i.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(i);const o=t.createElementNS(V,"line");o.classList.add(Ar("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const s=t.createElementNS(V,"line");s.classList.add(Ar("l")),s.setAttributeNS(null,"x1","50%"),s.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(s),this.lineElem_=s;const a=t.createElement("div");a.classList.add(Ar("m")),this.padElement.appendChild(a),this.markerElem_=a,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}}function Fr(t,e,n){return[Re(e[0],Ve(t)),Re(e[1],Be(t))*(n?1:-1)]}class Rr{handlePointerEvent_(t,e){if(!t.point)return;const n=this.maxValue_,r=Ie(t.point.x,0,t.bounds.width,-n,+n),i=Ie(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-n,+n);this.value.setRawValue(new Pr(r,i),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){Le(t.key)&&t.preventDefault();const[e,n]=Fr(t,this.baseSteps_,this.invertsY_);0===e&&0===n||this.value.setRawValue(new Pr(this.value.rawValue.x+e,this.value.rawValue.y+n),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,n]=Fr(t,this.baseSteps_,this.invertsY_);0===e&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new Sr(t,{invertsY:this.invertsY_,layout:e.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ue(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}}class Br{onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,n=t.relatedTarget;n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=H(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!D(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}constructor(t,e){var n,r;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=$.create(e.expanded),this.popC_="popup"===e.pickerLayout?new Qt(t,{viewProps:this.viewProps}):null;const i=new Rr(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,layout:e.pickerLayout,maxValue:e.maxValue,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.textC_=new xr(t,{assembly:Tr,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new kr(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("blur",this.onPadButtonBlur_),null===(r=this.view.buttonElement)||void 0===r||r.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Fe({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Z(this.foldable_,this.view.pickerElement))}}function Vr(t){return Pr.isObject(t)?new Pr(t.x,t.y):new Pr}function Lr(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function Dr(t){if(!t)return;const e=[];return s(t.step)||e.push(new Gt(t.step)),s(t.max)&&s(t.min)||e.push(new Kt({max:t.max,min:t.min})),new zt(e)}function Ur(t,e){const n=t&&jt(t,Kt);if(n)return Math.max(Math.abs(n.minValue||0),Math.abs(n.maxValue||0));const r=sn(t);return Math.max(10*Math.abs(r),10*Math.abs(e))}function Ir(t,e){const n=e instanceof _r?e.components[0]:void 0,r=e instanceof _r?e.components[1]:void 0,i=Ur(n,t.x),o=Ur(r,t.y);return Math.max(i,o)}function Or(t,e){return{baseStep:sn(e),constraint:e,textProps:T.fromObject({draggingScale:an(e,t),formatter:Ee(on(e,t))})}}function Nr(t){if(!("y"in t))return!1;const e=t.y;return!!e&&("inverted"in e&&!!e.inverted)}const zr={id:"input-point2d",type:"input",accept:(t,e)=>{if(!Pr.isObject(t))return null;const n=A,r=S(e,{expanded:n.optional.boolean,picker:n.optional.custom(Je),x:n.optional.custom(tn),y:n.optional.object({inverted:n.optional.boolean,max:n.optional.number,min:n.optional.number,step:n.optional.number})});return r?{initialValue:t,params:r}:null},binding:{reader:t=>Vr,constraint:t=>{return e=t.params,new _r({assembly:Tr,components:[Dr("x"in e?e.x:void 0),Dr("y"in e?e.y:void 0)]});var e},equals:Pr.equals,writer:t=>Lr},controller:t=>{const e=t.document,n=t.value,r=t.constraint;if(!(r instanceof _r))throw u.shouldNeverHappen();const i="expanded"in t.params?t.params.expanded:void 0,o="picker"in t.params?t.params.picker:void 0;return new Br(e,{axes:[Or(n.rawValue.x,r.components[0]),Or(n.rawValue.y,r.components[1])],expanded:null!=i&&i,invertsY:Nr(t.params),maxValue:Ir(n.rawValue,r),parser:we,pickerLayout:null!=o?o:"popup",value:n,viewProps:t.viewProps})}};class jr{getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(s(t))return!1;const e=t.x,n=t.y,r=t.z;return"number"==typeof e&&"number"==typeof n&&"number"==typeof r}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}}const Hr={toComponents:t=>t.getComponents(),fromComponents:t=>new jr(...t)};function Kr(t){return jr.isObject(t)?new jr(t.x,t.y,t.z):new jr}function Gr(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}function Wr(t){if(!t)return;const e=[];return s(t.step)||e.push(new Gt(t.step)),s(t.max)&&s(t.min)||e.push(new Kt({max:t.max,min:t.min})),new zt(e)}function qr(t,e){return{baseStep:sn(e),constraint:e,textProps:T.fromObject({draggingScale:an(e,t),formatter:Ee(on(e,t))})}}const Xr={id:"input-point3d",type:"input",accept:(t,e)=>{if(!jr.isObject(t))return null;const n=A,r=S(e,{x:n.optional.custom(tn),y:n.optional.custom(tn),z:n.optional.custom(tn)});return r?{initialValue:t,params:r}:null},binding:{reader:t=>Kr,constraint:t=>{return e=t.params,new _r({assembly:Hr,components:[Wr("x"in e?e.x:void 0),Wr("y"in e?e.y:void 0),Wr("z"in e?e.z:void 0)]});var e},equals:jr.equals,writer:t=>Gr},controller:t=>{const e=t.value,n=t.constraint;if(!(n instanceof _r))throw u.shouldNeverHappen();return new xr(t.document,{assembly:Hr,axes:[qr(e.rawValue.x,n.components[0]),qr(e.rawValue.y,n.components[1]),qr(e.rawValue.z,n.components[2])],parser:we,value:e,viewProps:t.viewProps})}};class Yr{getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(s(t))return!1;const e=t.x,n=t.y,r=t.z,i=t.w;return"number"==typeof e&&"number"==typeof n&&"number"==typeof r&&"number"==typeof i}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}constructor(t=0,e=0,n=0,r=0){this.x=t,this.y=e,this.z=n,this.w=r}}const $r={toComponents:t=>t.getComponents(),fromComponents:t=>new Yr(...t)};function Qr(t){return Yr.isObject(t)?new Yr(t.x,t.y,t.z,t.w):new Yr}function Zr(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}function Jr(t){if(!t)return;const e=[];return s(t.step)||e.push(new Gt(t.step)),s(t.max)&&s(t.min)||e.push(new Kt({max:t.max,min:t.min})),new zt(e)}const ti={id:"input-point4d",type:"input",accept:(t,e)=>{if(!Yr.isObject(t))return null;const n=A,r=S(e,{x:n.optional.custom(tn),y:n.optional.custom(tn),z:n.optional.custom(tn),w:n.optional.custom(tn)});return r?{initialValue:t,params:r}:null},binding:{reader:t=>Qr,constraint:t=>{return e=t.params,new _r({assembly:$r,components:[Jr("x"in e?e.x:void 0),Jr("y"in e?e.y:void 0),Jr("z"in e?e.z:void 0),Jr("w"in e?e.w:void 0)]});var e},equals:Yr.equals,writer:t=>Zr},controller:t=>{const e=t.value,n=t.constraint;if(!(n instanceof _r))throw u.shouldNeverHappen();return new xr(t.document,{assembly:$r,axes:e.rawValue.getComponents().map(((t,e)=>{return r=t,{baseStep:sn(i=n.components[e]),constraint:i,textProps:T.fromObject({draggingScale:an(i,r),formatter:Ee(on(i,r))})};var r,i})),parser:we,value:e,viewProps:t.viewProps})}};const ei={id:"input-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;const n=S(e,{options:A.optional.custom(Ze)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Te,constraint:t=>function(t){const e=[],n=nn(t.options);return n&&e.push(n),new zt(e)}(t.params),writer:t=>Qe},controller:t=>{var e;const n=t.document,r=t.value,i=t.constraint;return i&&jt(i,Ht)?new Xt(n,{props:T.fromObject({options:null!==(e=rn(i))&&void 0!==e?e:[]}),value:r,viewProps:t.viewProps}):new te(n,{parser:t=>t,props:T.fromObject({formatter:Me}),value:r,viewProps:t.viewProps})}},ni={defaultInterval:200,defaultLineCount:3},ri=v("mll");class ii{update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,n=[];this.value.rawValue.forEach((t=>{void 0!==t&&n.push(this.formatter_(t))})),t.textContent=n.join("\n"),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(ri()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("textarea");n.classList.add(ri("i")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,n.readOnly=!0,e.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}}class oi{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new ii(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value,viewProps:this.viewProps})}}const si=v("sgl");class ai{update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}onValueUpdate_(){this.update_()}constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(si()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(si("i")),n.readOnly=!0,n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}}class li{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new ai(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}const ui={id:"monitor-bool",type:"monitor",accept:(t,e)=>{if("boolean"!=typeof t)return null;const n=S(e,{lineCount:A.optional.number});return n?{initialValue:t,params:n}:null},binding:{reader:t=>ee},controller:t=>{var e;return 1===t.value.rawValue.length?new li(t.document,{formatter:ne,value:t.value,viewProps:t.viewProps}):new oi(t.document,{formatter:ne,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:ni.defaultLineCount,value:t.value,viewProps:t.viewProps})}};class ci{get index(){return this.index_}set index(t){this.index_!==t&&(this.index_=t,this.emitter.emit("change",{index:t,sender:this}))}constructor(){this.emitter=new d,this.index_=-1}}const hi=v("grl");class di{get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.minValue_,r=this.maxValue_,i=[];this.value.rawValue.forEach(((o,s)=>{if(void 0===o)return;const a=Ie(s,0,e,0,t.width),l=Ie(o,n,r,t.height,0);i.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",i.join(" "));const o=this.tooltipElem_,s=this.value.rawValue[this.cursor_.index];if(void 0===s)return void o.classList.remove(hi("t","a"));const a=Ie(this.cursor_.index,0,e,0,t.width),l=Ie(s,n,r,t.height,0);o.style.left=`${a}px`,o.style.top=`${l}px`,o.textContent=`${this.formatter_(s)}`,o.classList.contains(hi("t","a"))||(o.classList.add(hi("t","a"),hi("t","in")),L(o),o.classList.remove(hi("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(hi()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.minValue_=e.minValue,this.maxValue_=e.maxValue,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=t.createElementNS(V,"svg");n.classList.add(hi("g")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(n),this.svgElem_=n;const r=t.createElementNS(V,"polyline");this.svgElem_.appendChild(r),this.lineElem_=r;const i=t.createElement("div");i.classList.add(hi("t"),v("tt")()),this.element.appendChild(i),this.tooltipElem_=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}}class pi{onGraphMouseLeave_(){this.cursor_.index=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.index=Math.floor(Ie(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.index=Math.floor(Ie(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.index=-1}onGraphPointerUp_(){this.cursor_.index=-1}constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.cursor_=new ci,this.view=new di(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,maxValue:e.maxValue,minValue:e.minValue,value:this.value,viewProps:this.viewProps}),D(t)){const t=new Ue(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}}function vi(t){return"format"in t&&!s(t.format)?t.format:Ee(2)}function fi(t){return"view"in t&&"graph"===t.view}const mi={id:"monitor-number",type:"monitor",accept:(t,e)=>{if("number"!=typeof t)return null;const n=A,r=S(e,{format:n.optional.function,lineCount:n.optional.number,max:n.optional.number,min:n.optional.number,view:n.optional.string});return r?{initialValue:t,params:r}:null},binding:{defaultBufferSize:t=>fi(t)?64:1,reader:t=>xe},controller:t=>fi(t.params)?function(t){var e,n,r;return new pi(t.document,{formatter:vi(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:ni.defaultLineCount,maxValue:null!==(n="max"in t.params?t.params.max:null)&&void 0!==n?n:100,minValue:null!==(r="min"in t.params?t.params.min:null)&&void 0!==r?r:0,value:t.value,viewProps:t.viewProps})}(t):function(t){var e;return 1===t.value.rawValue.length?new li(t.document,{formatter:vi(t.params),value:t.value,viewProps:t.viewProps}):new oi(t.document,{formatter:vi(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:ni.defaultLineCount,value:t.value,viewProps:t.viewProps})}(t)},bi={id:"monitor-string",type:"monitor",accept:(t,e)=>{if("string"!=typeof t)return null;const n=A,r=S(e,{lineCount:n.optional.number,multiline:n.optional.boolean});return r?{initialValue:t,params:r}:null},binding:{reader:t=>Te},controller:t=>{var e;const n=t.value;return n.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new oi(t.document,{formatter:Me,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:ni.defaultLineCount,value:n,viewProps:t.viewProps}):new li(t.document,{formatter:Me,value:n,viewProps:t.viewProps})}};class _i{read(){const t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))}write_(t){this.writer(this.target,t)}onValueChange_(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}constructor(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new d,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}}class gi{dispose(){this.ticker.dispose()}read(){const t=this.target.read();if(void 0===t)return;const e=this.value.rawValue,n=this.reader_(t);this.value.rawValue=function(t,e){const n=[...Se(t),e];return n.length>t.length?n.splice(0,n.length-t.length):ke(n,t.length),n}(e,n),this.emitter.emit("update",{rawValue:n,sender:this})}onTick_(t){this.read()}constructor(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new d,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}}function wi(t,e){return 0===e?new Ot:new Nt(t,null!=e?e:ni.defaultInterval)}class xi{getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t){"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}createInput(t,e,n){if(s(e.read()))throw new u({context:{key:e.key},type:"nomatchingcontroller"});const r=this.pluginsMap_.inputs.reduce(((r,i)=>r||function(t,e){const n=t.accept(e.target.read(),e.params);if(s(n))return null;const r=A,i={target:e.target,initialValue:n.initialValue,params:n.params},o=t.binding.reader(i),a=t.binding.constraint?t.binding.constraint(i):void 0,l=P(o(n.initialValue),{constraint:a,equals:t.binding.equals}),u=new _i({reader:o,target:e.target,value:l,writer:t.binding.writer(i)}),c=r.optional.boolean(e.params.disabled).value,h=r.optional.boolean(e.params.hidden).value,d=t.controller({constraint:a,document:e.document,initialValue:n.initialValue,params:n.params,value:u.value,viewProps:kt.create({disabled:c,hidden:h})}),p=r.optional.string(e.params.label).value;return new nt(e.document,{binding:u,blade:Y(),props:T.fromObject({label:p||e.target.key}),valueController:d})}(i,{document:t,target:e,params:n})),null);if(r)return r;throw new u({context:{key:e.key},type:"nomatchingcontroller"})}createMonitor(t,e,n){const r=this.pluginsMap_.monitors.reduce(((r,i)=>r||function(t,e){var n,r,i;const o=A,a=t.accept(e.target.read(),e.params);if(s(a))return null;const l={target:e.target,initialValue:a.initialValue,params:a.params},u=t.binding.reader(l),c=null!==(r=null!==(n=o.optional.number(e.params.bufferSize).value)&&void 0!==n?n:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(a.params))&&void 0!==r?r:1,h=o.optional.number(e.params.interval).value,d=new gi({reader:u,target:e.target,ticker:wi(e.document,h),value:Ae(c)}),p=o.optional.boolean(e.params.disabled).value,v=o.optional.boolean(e.params.hidden).value,f=t.controller({document:e.document,params:a.params,value:d.value,viewProps:kt.create({disabled:p,hidden:v})}),m=null!==(i=o.optional.string(e.params.label).value)&&void 0!==i?i:e.target.key;return new it(e.document,{binding:d,blade:Y(),props:T.fromObject({label:m}),valueController:f})}(i,{document:t,params:n,target:e})),null);if(r)return r;throw new u({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const n=this.pluginsMap_.blades.reduce(((n,r)=>n||function(t,e){const n=t.accept(e.params);if(!n)return null;const r=A.optional.boolean(e.params.disabled).value,i=A.optional.boolean(e.params.hidden).value;return t.controller({blade:Y(),document:e.document,params:Object.assign(Object.assign({},n.params),{disabled:r,hidden:i}),viewProps:kt.create({disabled:r,hidden:i})})}(r,{document:t,params:e})),null);if(!n)throw new u({type:"nomatchingview",context:{params:e}});return n}createBladeApi(t){if(t instanceof nt)return new et(t);if(t instanceof it)return new rt(t);if(t instanceof ft)return new lt(t,this);const e=this.pluginsMap_.blades.reduce(((e,n)=>e||n.api({controller:t,pool:this})),null);if(!e)throw u.shouldNeverHappen();return e}constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}}class Ci extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get options(){return this.controller_.valueController.props.get("options")}set options(t){this.controller_.valueController.props.set("options",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}constructor(t){super(t),this.emitter_=new d,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new r(this,t.rawValue)})}))}}class Ei extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(t){this.controller_.valueController.sliderController.props.set("minValue",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}constructor(t){super(t),this.emitter_=new d,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new r(this,t.rawValue)})}))}}class yi extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(t){this.controller_.valueController.props.set("formatter",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}constructor(t){super(t),this.emitter_=new d,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new r(this,t.rawValue)})}))}}const Pi={id:"list",type:"blade",accept(t){const e=A,n=S(t,{options:e.required.custom(Ze),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return n?{params:n}:null},controller(t){const e=new Xt(t.document,{props:T.fromObject({options:en(t.params.options)}),value:P(t.params.value),viewProps:t.viewProps});return new wt(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:e})},api:t=>t.controller instanceof wt&&t.controller.valueController instanceof Xt?new Ci(t.controller):null};class Ti extends ut{get element(){return this.controller_.view.element}importPreset(t){!function(t,e){t.forEach((t=>{const n=e[t.presetKey];void 0!==n&&t.write(n)}))}(this.controller_.rackController.rack.find(nt).map((t=>t.binding.target)),t),this.refresh()}exportPreset(){return function(t){return t.reduce(((t,e)=>Object.assign(t,{[e.presetKey]:e.read()})),{})}(this.controller_.rackController.rack.find(nt).map((t=>t.binding.target)))}refresh(){this.controller_.rackController.rack.find(nt).forEach((t=>{t.binding.read()})),this.controller_.rackController.rack.find(it).forEach((t=>{t.binding.read()}))}constructor(t,e){super(t,e)}}class Mi extends _t{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const ki={id:"slider",type:"blade",accept(t){const e=A,n=S(t,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return n?{params:n}:null},controller(t){var e,n;const r=null!==(e=t.params.value)&&void 0!==e?e:0,i=new $e(t.document,{baseStep:1,parser:we,sliderProps:T.fromObject({maxValue:t.params.max,minValue:t.params.min}),textProps:T.fromObject({draggingScale:an(void 0,r),formatter:null!==(n=t.params.format)&&void 0!==n?n:Ce}),value:P(r),viewProps:t.viewProps});return new wt(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:i})},api:t=>t.controller instanceof wt&&t.controller.valueController instanceof $e?new Ei(t.controller):null},Ai={id:"text",type:"blade",accept(t){const e=A,n=S(t,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return n?{params:n}:null},controller(t){var e;const n=new te(t.document,{parser:t.params.parse,props:T.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:t=>String(t)}),value:P(t.params.value),viewProps:t.viewProps});return new wt(t.document,{blade:t.blade,props:T.fromObject({label:t.params.label}),valueController:n})},api:t=>t.controller instanceof wt&&t.controller.valueController instanceof te?new yi(t.controller):null};function Si(t,e,n){if(t.querySelector(`style[data-tp-style=${e}]`))return;const r=t.createElement("style");r.dataset.tpStyle=e,r.textContent=n,t.head.appendChild(r)}const Fi=new class{toString(){const t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}constructor(t){const[e,n]=t.split("-"),r=e.split(".");this.major=parseInt(r[0],10),this.minor=parseInt(r[1],10),this.patch=parseInt(r[2],10),this.prerelease=null!=n?n:null}}("3.0.7");t.BladeApi=e,t.ButtonApi=h,t.FolderApi=ut,t.InputBindingApi=et,t.ListApi=Ci,t.MonitorBindingApi=rt,t.Pane=class extends Ti{get document(){if(!this.doc_)throw u.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw u.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach((t=>{this.pool_.register(t),this.embedPluginStyle_(t)}))}embedPluginStyle_(t){t.css&&Si(this.document,`plugin-${t.id}`,t.css)}setUpDefaultPlugins_(){Si(this.document,"default",".tp-lstv_s,.tp-btnv_b,.tp-p2dv_b,.tp-colswv_sw,.tp-p2dpv_p,.tp-txtv_i,.tp-grlv_g,.tp-sglv_i,.tp-mllv_i,.tp-fldv_b,.tp-rotv_b,.tp-ckbv_i,.tp-coltxtv_ms,.tp-tbiv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-lstv_s,.tp-btnv_b,.tp-p2dv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-lstv_s:hover,.tp-btnv_b:hover,.tp-p2dv_b:hover{background-color:var(--btn-bg-h)}.tp-lstv_s:focus,.tp-btnv_b:focus,.tp-p2dv_b:focus{background-color:var(--btn-bg-f)}.tp-lstv_s:active,.tp-btnv_b:active,.tp-p2dv_b:active{background-color:var(--btn-bg-a)}.tp-lstv_s:disabled,.tp-btnv_b:disabled,.tp-p2dv_b:disabled{opacity:0.5}.tp-colswv_sw,.tp-p2dpv_p,.tp-txtv_i{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-colswv_sw:hover,.tp-p2dpv_p:hover,.tp-txtv_i:hover{background-color:var(--in-bg-h)}.tp-colswv_sw:focus,.tp-p2dpv_p:focus,.tp-txtv_i:focus{background-color:var(--in-bg-f)}.tp-colswv_sw:active,.tp-p2dpv_p:active,.tp-txtv_i:active{background-color:var(--in-bg-a)}.tp-colswv_sw:disabled,.tp-p2dpv_p:disabled,.tp-txtv_i:disabled{opacity:0.5}.tp-grlv_g,.tp-sglv_i,.tp-mllv_i{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);width:100%}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono,Source Code Pro,Menlo,Courier,monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #2f3137);--bs-sh: var(--tp-base-shadow-color, rgba(0,0,0,0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #2f3137);--cnt-bg: var(--tp-container-background-color, rgba(187,188,196,0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187,188,196,0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187,188,196,0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187,188,196,0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187,188,196,0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187,188,196,0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187,188,196,0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187,188,196,0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187,188,196,0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0,0,0,0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187,188,196,0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(0,0,0,0.2))}.tp-fldv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-rotv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1 * var(--cnt-v-p))}.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-fldv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-rotv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-fldv_c>.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv{margin-left:4px}.tp-fldv_c>.tp-fldv>.tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-fldv_c .tp-fldv>.tp-fldv_c,.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-fldv_c>.tp-tabv>.tp-tabv_i,.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-fldv_c .tp-tabv>.tp-tabv_c,.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-fldv_b,.tp-rotv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(2px * 2 + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-fldv_b:hover,.tp-rotv_b:hover{background-color:var(--cnt-bg-h)}.tp-fldv_b:focus,.tp-rotv_b:focus{background-color:var(--cnt-bg-f)}.tp-fldv_b:active,.tp-rotv_b:active{background-color:var(--cnt-bg-a)}.tp-fldv_b:disabled,.tp-rotv_b:disabled{opacity:0.5}.tp-fldv_m,.tp-rotv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:'';display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px) / 2 - 2px);margin:auto;opacity:0.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m,.tp-rotv.tp-rotv-expanded .tp-rotv_m{transform:none}.tp-fldv_c,.tp-rotv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c,.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c{display:none}.tp-fldv.tp-fldv-expanded>.tp-fldv_c,.tp-rotv.tp-rotv-expanded .tp-rotv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-coltxtv_m,.tp-lstv{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-coltxtv_mm,.tp-lstv_m{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-coltxtv_mm svg,.tp-lstv_m svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-coltxtv_mm svg path,.tp-lstv_m svg path{fill:currentColor}.tp-coltxtv_w,.tp-pndtxtv{display:flex}.tp-coltxtv_c,.tp-pndtxtv_a{width:100%}.tp-coltxtv_c+.tp-coltxtv_c,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-pndtxtv_a{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:0.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:'';height:2px;left:calc(-1 * var(--cnt-h-p));position:absolute;right:calc(-1 * var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us) * 4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0,0,0,0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,0.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,0.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,0.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,0.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br)}.tp-colswv.tp-v-disabled{opacity:0.5}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,0.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:'';display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us) * 3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left 0.05s, top 0.05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:0.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:0.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:0.5}.tp-mllv_i{display:block;height:calc(var(--bld-us) * 3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:0.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1 * var(--cnt-h-p));right:calc(-1 * var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:0.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:0.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:0.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:'';display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:'';display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:0.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:'';height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:'';height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:0.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:0.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:0.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:'';height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:0.1;position:absolute;top:0;transition:border-radius 0.1s, height 0.1s, transform 0.1s, width 0.1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:'';font-size:0.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(2px * 2 + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1 * var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1 * var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}"),this.pool_.getAll().forEach((t=>{this.embedPluginStyle_(t)})),this.registerPlugin({plugins:[ki,Pi,It,Ai]})}constructor(t){var e;const n=t||{},r=null!==(e=n.document)&&void 0!==e?e:U(),i=function(){const t=new xi;return[zr,Xr,ti,ei,yr,br,mr,fr,hn,ui,bi,mi,q,gt,Pt,It].forEach((e=>{t.register(e)})),t}();super(new Mi(r,{expanded:n.expanded,blade:Y(),props:T.fromObject({title:n.title}),viewProps:kt.create()}),i),this.pool_=i,this.containerElem_=n.container||function(t){const e=t.createElement("div");return e.classList.add(v("dfw")()),t.body&&t.body.appendChild(e),e}(r),this.containerElem_.appendChild(this.element),this.doc_=r,this.usesDefaultWrapper_=!n.container,this.setUpDefaultPlugins_()}},t.SeparatorApi=xt,t.SliderApi=Ei,t.TabApi=Vt,t.TabPageApi=Bt,t.TextApi=yi,t.TpChangeEvent=r,t.VERSION=Fi,Object.defineProperty(t,"__esModule",{value:!0})}));let h=Float32Array;function d(t,e,n){const r=new h(3);return t&&(r[0]=t),e&&(r[1]=e),n&&(r[2]=n),r}function p(t,e,n){return(n=n||new h(3))[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n}function v(t,e,n){return(n=n||new h(3))[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n}function f(t,e,n){n=n||new h(3);const r=t[2]*e[0]-t[0]*e[2],i=t[0]*e[1]-t[1]*e[0];return n[0]=t[1]*e[2]-t[2]*e[1],n[1]=r,n[2]=i,n}function m(t,e){e=e||new h(3);const n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=Math.sqrt(n);return r>1e-5?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=0,e[1]=0,e[2]=0),e}function b(t,e,n){return(n=n||new h(3))[0]=t[0]*e[0],n[1]=t[1]*e[1],n[2]=t[2]*e[2],n}let _,g,w,x=Float32Array;function C(t,e){return(e=e||new x(16))[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function E(t){return(t=t||new x(16))[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function y(t,e){e=e||new x(16);const n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],p=t[11],v=t[12],f=t[13],m=t[14],b=t[15],_=d*b,g=m*p,w=l*b,C=m*u,E=l*p,y=d*u,P=i*b,T=m*o,M=i*p,k=d*o,A=i*u,S=l*o,F=c*f,R=v*h,B=s*f,V=v*a,L=s*h,D=c*a,U=n*f,I=v*r,O=n*h,N=c*r,z=n*a,j=s*r,H=_*a+C*h+E*f-(g*a+w*h+y*f),K=g*r+P*h+k*f-(_*r+T*h+M*f),G=w*r+T*a+A*f-(C*r+P*a+S*f),W=y*r+M*a+S*h-(E*r+k*a+A*h),q=1/(n*H+s*K+c*G+v*W);return e[0]=q*H,e[1]=q*K,e[2]=q*G,e[3]=q*W,e[4]=q*(g*s+w*c+y*v-(_*s+C*c+E*v)),e[5]=q*(_*n+T*c+M*v-(g*n+P*c+k*v)),e[6]=q*(C*n+P*s+S*v-(w*n+T*s+A*v)),e[7]=q*(E*n+k*s+A*c-(y*n+M*s+S*c)),e[8]=q*(F*u+V*p+L*b-(R*u+B*p+D*b)),e[9]=q*(R*o+U*p+N*b-(F*o+I*p+O*b)),e[10]=q*(B*o+I*u+z*b-(V*o+U*u+j*b)),e[11]=q*(D*o+O*u+j*p-(L*o+N*u+z*p)),e[12]=q*(B*d+D*m+R*l-(L*m+F*l+V*d)),e[13]=q*(O*m+F*i+I*d-(U*d+N*m+R*i)),e[14]=q*(U*l+j*m+V*i-(z*m+B*i+I*l)),e[15]=q*(z*d+L*i+N*l-(O*l+j*d+D*i)),e}function P(t,e,n){n=n||d();const r=e[0],i=e[1],o=e[2],s=r*t[3]+i*t[7]+o*t[11]+t[15];return n[0]=(r*t[0]+i*t[4]+o*t[8]+t[12])/s,n[1]=(r*t[1]+i*t[5]+o*t[9]+t[13])/s,n[2]=(r*t[2]+i*t[6]+o*t[10]+t[14])/s,n}function T(t,e,n){n=n||d();const r=e[0],i=e[1],o=e[2];return n[0]=r*t[0]+i*t[4]+o*t[8],n[1]=r*t[1]+i*t[5]+o*t[9],n[2]=r*t[2]+i*t[6]+o*t[10],n}var M=Object.freeze({__proto__:null,axisRotate:function(t,e,n,r){r=r||new x(16);let i=e[0],o=e[1],s=e[2];const a=Math.sqrt(i*i+o*o+s*s);i/=a,o/=a,s/=a;const l=i*i,u=o*o,c=s*s,h=Math.cos(n),d=Math.sin(n),p=1-h,v=l+(1-l)*h,f=i*o*p+s*d,m=i*s*p-o*d,b=i*o*p-s*d,_=u+(1-u)*h,g=o*s*p+i*d,w=i*s*p+o*d,C=o*s*p-i*d,E=c+(1-c)*h,y=t[0],P=t[1],T=t[2],M=t[3],k=t[4],A=t[5],S=t[6],F=t[7],R=t[8],B=t[9],V=t[10],L=t[11];return r[0]=v*y+f*k+m*R,r[1]=v*P+f*A+m*B,r[2]=v*T+f*S+m*V,r[3]=v*M+f*F+m*L,r[4]=b*y+_*k+g*R,r[5]=b*P+_*A+g*B,r[6]=b*T+_*S+g*V,r[7]=b*M+_*F+g*L,r[8]=w*y+C*k+E*R,r[9]=w*P+C*A+E*B,r[10]=w*T+C*S+E*V,r[11]=w*M+C*F+E*L,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r},axisRotation:function(t,e,n){n=n||new x(16);let r=t[0],i=t[1],o=t[2];const s=Math.sqrt(r*r+i*i+o*o);r/=s,i/=s,o/=s;const a=r*r,l=i*i,u=o*o,c=Math.cos(e),h=Math.sin(e),d=1-c;return n[0]=a+(1-a)*c,n[1]=r*i*d+o*h,n[2]=r*o*d-i*h,n[3]=0,n[4]=r*i*d-o*h,n[5]=l+(1-l)*c,n[6]=i*o*d+r*h,n[7]=0,n[8]=r*o*d+i*h,n[9]=i*o*d-r*h,n[10]=u+(1-u)*c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},copy:C,frustum:function(t,e,n,r,i,o,s){const a=e-t,l=r-n,u=i-o;return(s=s||new x(16))[0]=2*i/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*i/l,s[6]=0,s[7]=0,s[8]=(t+e)/a,s[9]=(r+n)/l,s[10]=o/u,s[11]=-1,s[12]=0,s[13]=0,s[14]=i*o/u,s[15]=0,s},getAxis:function(t,e,n){const r=4*e;return(n=n||d())[0]=t[r+0],n[1]=t[r+1],n[2]=t[r+2],n},getTranslation:function(t,e){return(e=e||d())[0]=t[12],e[1]=t[13],e[2]=t[14],e},identity:E,inverse:y,lookAt:function(t,e,n,r){return r=r||new x(16),_=_||d(),g=g||d(),w=w||d(),m(v(t,e,w),w),m(f(n,w,_),_),m(f(w,_,g),g),r[0]=_[0],r[1]=_[1],r[2]=_[2],r[3]=0,r[4]=g[0],r[5]=g[1],r[6]=g[2],r[7]=0,r[8]=w[0],r[9]=w[1],r[10]=w[2],r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r},multiply:function(t,e,n){n=n||new x(16);const r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],p=t[10],v=t[11],f=t[12],m=t[13],b=t[14],_=t[15],g=e[0],w=e[1],C=e[2],E=e[3],y=e[4],P=e[5],T=e[6],M=e[7],k=e[8],A=e[9],S=e[10],F=e[11],R=e[12],B=e[13],V=e[14],L=e[15];return n[0]=r*g+a*w+h*C+f*E,n[1]=i*g+l*w+d*C+m*E,n[2]=o*g+u*w+p*C+b*E,n[3]=s*g+c*w+v*C+_*E,n[4]=r*y+a*P+h*T+f*M,n[5]=i*y+l*P+d*T+m*M,n[6]=o*y+u*P+p*T+b*M,n[7]=s*y+c*P+v*T+_*M,n[8]=r*k+a*A+h*S+f*F,n[9]=i*k+l*A+d*S+m*F,n[10]=o*k+u*A+p*S+b*F,n[11]=s*k+c*A+v*S+_*F,n[12]=r*R+a*B+h*V+f*L,n[13]=i*R+l*B+d*V+m*L,n[14]=o*R+u*B+p*V+b*L,n[15]=s*R+c*B+v*V+_*L,n},negate:function(t,e){return(e=e||new x(16))[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=-t[7],e[8]=-t[8],e[9]=-t[9],e[10]=-t[10],e[11]=-t[11],e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=-t[15],e},ortho:function(t,e,n,r,i,o,s){return(s=s||new x(16))[0]=2/(e-t),s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/(r-n),s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2/(i-o),s[11]=0,s[12]=(e+t)/(t-e),s[13]=(r+n)/(n-r),s[14]=(o+i)/(i-o),s[15]=1,s},perspective:function(t,e,n,r,i){i=i||new x(16);const o=Math.tan(.5*Math.PI-.5*t),s=1/(n-r);return i[0]=o/e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=o,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(n+r)*s,i[11]=-1,i[12]=0,i[13]=0,i[14]=n*r*s*2,i[15]=0,i},rotateX:function(t,e,n){n=n||new x(16);const r=t[4],i=t[5],o=t[6],s=t[7],a=t[8],l=t[9],u=t[10],c=t[11],h=Math.cos(e),d=Math.sin(e);return n[4]=h*r+d*a,n[5]=h*i+d*l,n[6]=h*o+d*u,n[7]=h*s+d*c,n[8]=h*a-d*r,n[9]=h*l-d*i,n[10]=h*u-d*o,n[11]=h*c-d*s,t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n},rotateY:function(t,e,n){n=n||new x(16);const r=t[0],i=t[1],o=t[2],s=t[3],a=t[8],l=t[9],u=t[10],c=t[11],h=Math.cos(e),d=Math.sin(e);return n[0]=h*r-d*a,n[1]=h*i-d*l,n[2]=h*o-d*u,n[3]=h*s-d*c,n[8]=h*a+d*r,n[9]=h*l+d*i,n[10]=h*u+d*o,n[11]=h*c+d*s,t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n},rotateZ:function(t,e,n){n=n||new x(16);const r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],u=t[6],c=t[7],h=Math.cos(e),d=Math.sin(e);return n[0]=h*r+d*a,n[1]=h*i+d*l,n[2]=h*o+d*u,n[3]=h*s+d*c,n[4]=h*a-d*r,n[5]=h*l-d*i,n[6]=h*u-d*o,n[7]=h*c-d*s,t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n},rotationX:function(t,e){e=e||new x(16);const n=Math.cos(t),r=Math.sin(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},rotationY:function(t,e){e=e||new x(16);const n=Math.cos(t),r=Math.sin(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},rotationZ:function(t,e){e=e||new x(16);const n=Math.cos(t),r=Math.sin(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},scale:function(t,e,n){n=n||new x(16);const r=e[0],i=e[1],o=e[2];return n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n[3]=r*t[3],n[4]=i*t[4],n[5]=i*t[5],n[6]=i*t[6],n[7]=i*t[7],n[8]=o*t[8],n[9]=o*t[9],n[10]=o*t[10],n[11]=o*t[11],t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n},scaling:function(t,e){return(e=e||new x(16))[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},setAxis:function(t,e,n,r){r!==t&&(r=C(t,r));const i=4*n;return r[i+0]=e[0],r[i+1]=e[1],r[i+2]=e[2],r},setDefaultType:function(t){const e=x;return x=t,e},setTranslation:function(t,e,n){return t!==(n=n||E())&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11]),n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n},transformDirection:T,transformNormal:function(t,e,n){n=n||d();const r=y(t),i=e[0],o=e[1],s=e[2];return n[0]=i*r[0]+o*r[1]+s*r[2],n[1]=i*r[4]+o*r[5]+s*r[6],n[2]=i*r[8]+o*r[9]+s*r[10],n},transformPoint:P,translate:function(t,e,n){n=n||new x(16);const r=e[0],i=e[1],o=e[2],s=t[0],a=t[1],l=t[2],u=t[3],c=t[4],h=t[5],d=t[6],p=t[7],v=t[8],f=t[9],m=t[10],b=t[11],_=t[12],g=t[13],w=t[14],C=t[15];return t!==n&&(n[0]=s,n[1]=a,n[2]=l,n[3]=u,n[4]=c,n[5]=h,n[6]=d,n[7]=p,n[8]=v,n[9]=f,n[10]=m,n[11]=b),n[12]=s*r+c*i+v*o+_,n[13]=a*r+h*i+f*o+g,n[14]=l*r+d*i+m*o+w,n[15]=u*r+p*i+b*o+C,n},translation:function(t,e){return(e=e||new x(16))[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},transpose:function(t,e){if((e=e||new x(16))===t){let n;return n=t[1],t[1]=t[4],t[4]=n,n=t[2],t[2]=t[8],t[8]=n,n=t[3],t[3]=t[12],t[12]=n,n=t[6],t[6]=t[9],t[9]=n,n=t[7],t[7]=t[13],t[13]=n,n=t[11],t[11]=t[14],t[14]=n,e}const n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],p=t[11],v=t[12],f=t[13],m=t[14],b=t[15];return e[0]=n,e[1]=s,e[2]=c,e[3]=v,e[4]=r,e[5]=a,e[6]=h,e[7]=f,e[8]=i,e[9]=l,e[10]=d,e[11]=m,e[12]=o,e[13]=u,e[14]=p,e[15]=b,e}});const k={};{const t=k;t[5120]=Int8Array,t[5121]=Uint8Array,t[5122]=Int16Array,t[5123]=Uint16Array,t[5124]=Int32Array,t[5125]=Uint32Array,t[5126]=Float32Array,t[32819]=Uint16Array,t[32820]=Uint16Array,t[33635]=Uint16Array,t[5131]=Uint16Array,t[33640]=Uint32Array,t[35899]=Uint32Array,t[35902]=Uint32Array,t[36269]=Uint32Array,t[34042]=Uint32Array}function A(t){if(t instanceof Int8Array)return 5120;if(t instanceof Uint8Array)return 5121;if(t instanceof Uint8ClampedArray)return 5121;if(t instanceof Int16Array)return 5122;if(t instanceof Uint16Array)return 5123;if(t instanceof Int32Array)return 5124;if(t instanceof Uint32Array)return 5125;if(t instanceof Float32Array)return 5126;throw new Error("unsupported typed array type")}function S(t){if(t===Int8Array)return 5120;if(t===Uint8Array)return 5121;if(t===Uint8ClampedArray)return 5121;if(t===Int16Array)return 5122;if(t===Uint16Array)return 5123;if(t===Int32Array)return 5124;if(t===Uint32Array)return 5125;if(t===Float32Array)return 5126;throw new Error("unsupported typed array type")}const F="undefined"!=typeof SharedArrayBuffer?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};function R(t,e){return"undefined"!=typeof WebGLTexture&&e instanceof WebGLTexture}const B={attribPrefix:""};function V(t,e,n,r,i){t.bindBuffer(e,n),t.bufferData(e,r,i||35044)}function L(t,e,n,r){if(i=e,"undefined"!=typeof WebGLBuffer&&i instanceof WebGLBuffer)return e;var i;n=n||34962;const o=t.createBuffer();return V(t,n,o,e,r),o}function D(t){return"indices"===t}function U(t){return t.length?t:t.data}const I=/coord|texture/i,O=/color|colour/i;function N(t,e){let n;if(n=I.test(t)?2:O.test(t)?4:3,e%n>0)throw new Error(`Can not guess numComponents for attribute '${t}'. Tried ${n} but ${e} values is not evenly divisible by ${n}. You should specify it.`);return n}function z(t,e){return t.numComponents||t.size||N(e,U(t).length)}function j(t,e){if(F(t))return t;if(F(t.data))return t.data;Array.isArray(t)&&(t={data:t});let n=t.type;return n||(n=D(e)?Uint16Array:Float32Array),new n(t.data)}function H(t,e){const n={};return Object.keys(e).forEach((function(r){if(!D(r)){const o=e[r],s=o.attrib||o.name||o.attribName||B.attribPrefix+r;if(o.value){if(!Array.isArray(o.value)&&!F(o.value))throw new Error("array.value is not array or typedarray");n[s]={value:o.value}}else{let e,a,l,u;if(o.buffer&&o.buffer instanceof WebGLBuffer)e=o.buffer,u=o.numComponents||o.size,a=o.type,l=o.normalize;else if("number"==typeof o||"number"==typeof o.data){const n=o.data||o,s=o.type||Float32Array,c=n*s.BYTES_PER_ELEMENT;a=S(s),l=void 0!==o.normalize?o.normalize:(i=s)===Int8Array||i===Uint8Array,u=o.numComponents||o.size||N(r,n),e=t.createBuffer(),t.bindBuffer(34962,e),t.bufferData(34962,c,o.drawType||35044)}else{const n=j(o,r);e=L(t,n,void 0,o.drawType),a=A(n),l=void 0!==o.normalize?o.normalize:function(t){return t instanceof Int8Array||t instanceof Uint8Array}(n),u=z(o,r)}n[s]={buffer:e,numComponents:u,type:a,normalize:l,stride:o.stride||0,offset:o.offset||0,divisor:void 0===o.divisor?void 0:o.divisor,drawType:o.drawType}}}var i})),t.bindBuffer(34962,null),n}const K=["position","positions","a_position"];function G(t,e,n){const r=H(t,e),i=Object.assign({},n||{});i.attribs=Object.assign({},n?n.attribs:{},r);const o=e.indices;if(o){const e=j(o,"indices");i.indices=L(t,e,34963),i.numElements=e.length,i.elementType=A(e)}else i.numElements||(i.numElements=function(t,e){let n,r;for(r=0;r<K.length&&(n=K[r],!(n in e))&&(n=B.attribPrefix+n,!(n in e));++r);r===K.length&&(n=Object.keys(e)[0]);const i=e[n];t.bindBuffer(34962,i.buffer);const o=t.getBufferParameter(34962,34660);var s;t.bindBuffer(34962,null);const a=o/(5120===(s=i.type)||5121===s?1:5122===s||5123===s?2:5124===s||5125===s||5126===s?4:0),l=i.numComponents||i.size,u=a/l;if(u%1!=0)throw new Error(`numComponents ${l} not correct for length ${length}`);return u}(t,i.attribs));return i}function W(t,e,n){const r="indices"===n?34963:34962;return L(t,j(e,n),r)}function q(t,e){const n={};return Object.keys(e).forEach((function(r){n[r]=W(t,e[r],r)})),e.indices?(n.numElements=e.indices.length,n.elementType=A(j(e.indices))):n.numElements=function(t){let e,n;for(n=0;n<K.length&&(e=K[n],!(e in t));++n);n===K.length&&(e=Object.keys(t)[0]);const r=t[e],i=U(r).length,o=z(r,e),s=i/o;if(i%o>0)throw new Error(`numComponents ${o} not correct for length ${i}`);return s}(e),n}const X=U,Y=z;function $(t,e){let n=0;return t.push=function(){for(let e=0;e<arguments.length;++e){const r=arguments[e];if(r instanceof Array||F(r))for(let e=0;e<r.length;++e)t[n++]=r[e];else t[n++]=r}},t.reset=function(t){n=t||0},t.numComponents=e,Object.defineProperty(t,"numElements",{get:function(){return this.length/this.numComponents|0}}),t}function Q(t,e,n){return $(new(n||Float32Array)(t*e),t)}function Z(t){return"indices"!==t}function J(t,e,n){const r=t.length,i=new Float32Array(3);for(let o=0;o<r;o+=3)n(e,[t[o],t[o+1],t[o+2]],i),t[o]=i[0],t[o+1]=i[1],t[o+2]=i[2]}function tt(t,e,n){n=n||d();const r=e[0],i=e[1],o=e[2];return n[0]=r*t[0]+i*t[1]+o*t[2],n[1]=r*t[4]+i*t[5]+o*t[6],n[2]=r*t[8]+i*t[9]+o*t[10],n}function et(t,e){return J(t,e,T),t}function nt(t,e){return J(t,y(e),tt),t}function rt(t,e){return J(t,e,P),t}function it(t,e){return Object.keys(t).forEach((function(n){const r=t[n];n.indexOf("pos")>=0?rt(r,e):n.indexOf("tan")>=0||n.indexOf("binorm")>=0?et(r,e):n.indexOf("norm")>=0&&nt(r,e)})),t}function ot(t,e,n){return t=t||2,{position:{numComponents:2,data:[(e=e||0)+-1*(t*=.5),(n=n||0)+-1*t,e+1*t,n+-1*t,e+-1*t,n+1*t,e+1*t,n+1*t]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function st(t,e,n,r,i){t=t||1,e=e||1,n=n||1,r=r||1,i=i||E();const o=(n+1)*(r+1),s=Q(3,o),a=Q(3,o),l=Q(2,o);for(let i=0;i<=r;i++)for(let o=0;o<=n;o++){const u=o/n,c=i/r;s.push(t*u-.5*t,0,e*c-.5*e),a.push(0,1,0),l.push(u,c)}const u=n+1,c=Q(3,n*r*2,Uint16Array);for(let t=0;t<r;t++)for(let e=0;e<n;e++)c.push((t+0)*u+e,(t+1)*u+e,(t+0)*u+e+1),c.push((t+1)*u+e,(t+1)*u+e+1,(t+0)*u+e+1);return it({position:s,normal:a,texcoord:l,indices:c},i)}function at(t,e,n,r,i,o,s){if(e<=0||n<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");r=r||0,o=o||0;const a=(i=i||Math.PI)-r,l=(s=s||2*Math.PI)-o,u=(e+1)*(n+1),c=Q(3,u),h=Q(3,u),d=Q(2,u);for(let i=0;i<=n;i++)for(let s=0;s<=e;s++){const u=s/e,p=i/n,v=l*u+o,f=a*p+r,m=Math.sin(v),b=Math.cos(v),_=Math.sin(f),g=b*_,w=Math.cos(f),x=m*_;c.push(t*g,t*w,t*x),h.push(g,w,x),d.push(1-u,p)}const p=e+1,v=Q(3,e*n*2,Uint16Array);for(let t=0;t<e;t++)for(let e=0;e<n;e++)v.push((e+0)*p+t,(e+0)*p+t+1,(e+1)*p+t),v.push((e+1)*p+t,(e+0)*p+t+1,(e+1)*p+t+1);return{position:c,normal:h,texcoord:d,indices:v}}const lt=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function ut(t){const e=(t=t||1)/2,n=[[-e,-e,-e],[+e,-e,-e],[-e,+e,-e],[+e,+e,-e],[-e,-e,+e],[+e,-e,+e],[-e,+e,+e],[+e,+e,+e]],r=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],i=[[1,0],[0,0],[0,1],[1,1]],o=Q(3,24),s=Q(3,24),a=Q(2,24),l=Q(3,12,Uint16Array);for(let t=0;t<6;++t){const e=lt[t];for(let l=0;l<4;++l){const u=n[e[l]],c=r[t],h=i[l];o.push(u),s.push(c),a.push(h)}const u=4*t;l.push(u+0,u+1,u+2),l.push(u+0,u+2,u+3)}return{position:o,normal:s,texcoord:a,indices:l}}function ct(t,e,n,r,i,o,s){if(r<3)throw new Error("radialSubdivisions must be 3 or greater");if(i<1)throw new Error("verticalSubdivisions must be 1 or greater");const a=void 0===o||o,l=void 0===s||s,u=(a?2:0)+(l?2:0),c=(r+1)*(i+1+u),h=Q(3,c),d=Q(3,c),p=Q(2,c),v=Q(3,r*(i+u/2)*2,Uint16Array),f=r+1,m=Math.atan2(t-e,n),b=Math.cos(m),_=Math.sin(m),g=i+(l?2:0);for(let o=a?-2:0;o<=g;++o){let s,a=o/i,l=n*a;o<0?(l=0,a=1,s=t):o>i?(l=n,a=1,s=e):s=t+o/i*(e-t),-2!==o&&o!==i+2||(s=0,a=0),l-=n/2;for(let t=0;t<f;++t){const e=Math.sin(t*Math.PI*2/r),n=Math.cos(t*Math.PI*2/r);h.push(e*s,l,n*s),o<0?d.push(0,-1,0):o>i?d.push(0,1,0):0===s?d.push(0,0,0):d.push(e*b,_,n*b),p.push(t/r,1-a)}}for(let t=0;t<i+u;++t)if(!(1===t&&a||t===i+u-2&&l))for(let e=0;e<r;++e)v.push(f*(t+0)+0+e,f*(t+0)+1+e,f*(t+1)+1+e),v.push(f*(t+0)+0+e,f*(t+1)+1+e,f*(t+1)+0+e);return{position:h,normal:d,texcoord:p,indices:v}}function ht(t,e){e=e||[];const n=[];for(let r=0;r<t.length;r+=4){const i=t[r],o=t.slice(r+1,r+4);o.push.apply(o,e);for(let t=0;t<i;++t)n.push.apply(n,o)}return n}function dt(){const t=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],e=ht([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),n=ht([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),r=t.length/3,i={position:Q(3,r),texcoord:Q(2,r),normal:Q(3,r),color:Q(4,r,Uint8Array),indices:Q(3,r/3,Uint16Array)};i.position.push(t),i.texcoord.push([.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0]),i.normal.push(e),i.color.push(n);for(let t=0;t<r;++t)i.indices.push(t);return i}function pt(t,e,n,r,i,o,s){if(i<=0)throw new Error("subdivisionDown must be > 0");const a=(s=s||1)-(o=o||0),l=2*(i+1)*4,u=Q(3,l),c=Q(3,l),h=Q(2,l);function d(t,e,n){return t+(e-t)*n}function v(e,n,s,l,v,f){for(let m=0;m<=i;m++){const _=n/1,g=m/i,w=2*(_-.5),x=(o+g*a)*Math.PI,C=Math.sin(x),E=Math.cos(x),y=d(t,e,C),P=w*r,T=E*t,M=C*y;u.push(P,T,M);const k=p(b([0,C,E],s),l);c.push(k),h.push(_*v+f,g)}}for(let t=0;t<2;t++){const r=2*(t/1-.5);v(e,t,[1,1,1],[0,0,0],1,0),v(e,t,[0,0,0],[r,0,0],0,0),v(n,t,[1,1,1],[0,0,0],1,0),v(n,t,[0,0,0],[r,0,0],0,1)}const f=Q(3,2*i*4,Uint16Array);function m(t,e){for(let n=0;n<i;++n)f.push(t+n+0,t+n+1,e+n+0),f.push(t+n+1,e+n+1,e+n+0)}const _=i+1;return m(0*_,4*_),m(5*_,7*_),m(6*_,2*_),m(3*_,1*_),{position:u,normal:c,texcoord:h,indices:f}}function vt(t,e,n,r,i,o){return ct(t,t,e,n,r,i,o)}function ft(t,e,n,r,i,o){if(n<3)throw new Error("radialSubdivisions must be 3 or greater");if(r<3)throw new Error("verticalSubdivisions must be 3 or greater");i=i||0;const s=(o=o||2*Math.PI)-i,a=n+1,l=r+1,u=a*l,c=Q(3,u),h=Q(3,u),d=Q(2,u),p=Q(3,n*r*2,Uint16Array);for(let o=0;o<l;++o){const l=o/r,u=l*Math.PI*2,p=Math.sin(u),v=t+p*e,f=Math.cos(u),m=f*e;for(let t=0;t<a;++t){const e=t/n,r=i+e*s,o=Math.sin(r),a=Math.cos(r),u=o*v,b=a*v,_=o*p,g=a*p;c.push(u,m,b),h.push(_,f,g),d.push(e,1-l)}}for(let t=0;t<r;++t)for(let e=0;e<n;++e){const n=1+e,r=1+t;p.push(a*t+e,a*r+e,a*t+n),p.push(a*r+e,a*r+n,a*t+n)}return{position:c,normal:h,texcoord:d,indices:p}}function mt(t,e,n,r,i){if(e<3)throw new Error("divisions must be at least 3");i=i||1,r=r||0;const o=(e+1)*((n=n||1)+1),s=Q(3,o),a=Q(3,o),l=Q(2,o),u=Q(3,n*e*2,Uint16Array);let c=0;const h=t-r,d=e+1;for(let t=0;t<=n;++t){const o=r+h*Math.pow(t/n,i);for(let r=0;r<=e;++r){const i=2*Math.PI*r/e,h=o*Math.cos(i),p=o*Math.sin(i);if(s.push(h,0,p),a.push(0,1,0),l.push(1-r/e,t/n),t>0&&r!==e){const t=c+(r+1),e=c+r,n=c+r-d,i=c+(r+1)-d;u.push(t,e,n),u.push(t,n,i)}}c+=e+1}return{position:s,normal:a,texcoord:l,indices:u}}function bt(t){return function(e){const n=t.apply(this,Array.prototype.slice.call(arguments,1));return q(e,n)}}function _t(t){return function(e){const n=t.apply(null,Array.prototype.slice.call(arguments,1));return G(e,n)}}const gt=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function wt(t,e,n,r){r=r||0;const i=t.length;for(let o=0;o<i;++o)e[n+o]=t[o]+r}function xt(t,e){const n=X(t),r=new n.constructor(e);let i=r;var o,s;return n.numComponents&&n.numElements&&$(r,n.numComponents),t.data&&(i={data:r},o=t,s=i,gt.forEach((function(t){const e=o[t];void 0!==e&&(s[t]=e)}))),i}const Ct=_t(dt),Et=bt(dt),yt=_t(ut),Pt=bt(ut),Tt=_t(st),Mt=bt(st),kt=_t(at),At=bt(at),St=_t(ct),Ft=bt(ct),Rt=_t(ot),Bt=bt(ot),Vt=_t(pt),Lt=bt(pt),Dt=_t(vt),Ut=bt(vt),It=_t(ft),Ot=bt(ft),Nt=_t(mt),zt=bt(mt),jt=Vt,Ht=Lt,Kt=pt;var Gt=Object.freeze({__proto__:null,create3DFBufferInfo:Ct,create3DFBuffers:Et,create3DFVertices:dt,createAugmentedTypedArray:Q,createCubeBufferInfo:yt,createCubeBuffers:Pt,createCubeVertices:ut,createPlaneBufferInfo:Tt,createPlaneBuffers:Mt,createPlaneVertices:st,createSphereBufferInfo:kt,createSphereBuffers:At,createSphereVertices:at,createTruncatedConeBufferInfo:St,createTruncatedConeBuffers:Ft,createTruncatedConeVertices:ct,createXYQuadBufferInfo:Rt,createXYQuadBuffers:Bt,createXYQuadVertices:ot,createCresentBufferInfo:jt,createCresentBuffers:Ht,createCresentVertices:Kt,createCrescentBufferInfo:Vt,createCrescentBuffers:Lt,createCrescentVertices:pt,createCylinderBufferInfo:Dt,createCylinderBuffers:Ut,createCylinderVertices:vt,createTorusBufferInfo:It,createTorusBuffers:Ot,createTorusVertices:ft,createDiscBufferInfo:Nt,createDiscBuffers:zt,createDiscVertices:mt,deindexVertices:function(t){const e=t.indices,n={},r=e.length;return Object.keys(t).filter(Z).forEach((function(i){const o=t[i],s=o.numComponents,a=Q(s,r,o.constructor);for(let t=0;t<r;++t){const n=e[t]*s;for(let t=0;t<s;++t)a.push(o[n+t])}n[i]=a})),n},flattenNormals:function(t){if(t.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");const e=t.normal,n=e.length;for(let t=0;t<n;t+=9){const n=e[t+0],r=e[t+1],i=e[t+2],o=e[t+3],s=e[t+4],a=e[t+5];let l=n+o+e[t+6],u=r+s+e[t+7],c=i+a+e[t+8];const h=Math.sqrt(l*l+u*u+c*c);l/=h,u/=h,c/=h,e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=l,e[t+4]=u,e[t+5]=c,e[t+6]=l,e[t+7]=u,e[t+8]=c}return t},makeRandomVertexColors:function(t,e){e=e||{};const n=t.position.numElements,r=Q(4,n,Uint8Array),i=e.rand||function(t,e){return e<3?(n=256,Math.random()*n|0):255;var n};if(t.color=r,t.indices)for(let t=0;t<n;++t)r.push(i(t,0),i(t,1),i(t,2),i(t,3));else{const t=e.vertsPerColor||3,o=n/t;for(let e=0;e<o;++e){const n=[i(e,0),i(e,1),i(e,2),i(e,3)];for(let e=0;e<t;++e)r.push(n)}}return t},reorientDirections:et,reorientNormals:nt,reorientPositions:rt,reorientVertices:it,concatVertices:function(t){const e={};let n;for(let r=0;r<t.length;++r){const i=t[r];Object.keys(i).forEach((function(t){e[t]||(e[t]=[]),n||"indices"===t||(n=t);const r=i[t],o=Y(r,t),s=X(r).length/o;e[t].push(s)}))}const r=e[n],i={};return Object.keys(e).forEach((function(e){const n=function(e){let n,r=0;for(let i=0;i<t.length;++i){const o=t[i][e];r+=X(o).length,n&&!o.data||(n=o)}return{length:r,spec:n}}(e),o=xt(n.spec,n.length);!function(e,n,r){let i=0,o=0;for(let s=0;s<t.length;++s){const a=t[s][e],l=X(a);"indices"===e?(wt(l,r,o,i),i+=n[s]):wt(l,r,o),o+=l.length}}(e,r,X(o)),i[e]=o})),i},duplicateVertices:function(t){const e={};return Object.keys(t).forEach((function(n){const r=t[n],i=X(r),o=xt(r,i.length);wt(i,X(o),0),e[n]=o})),e}});function Wt(t){return!!t.texStorage2D}!function(){const t={},e={}}();new Uint8Array([128,192,255,255]),function(){let t}();const qt={};{const t=qt;t[6406]={numColorComponents:1},t[6409]={numColorComponents:1},t[6410]={numColorComponents:2},t[6407]={numColorComponents:3},t[6408]={numColorComponents:4},t[6403]={numColorComponents:1},t[36244]={numColorComponents:1},t[33319]={numColorComponents:2},t[33320]={numColorComponents:2},t[6407]={numColorComponents:3},t[36248]={numColorComponents:3},t[6408]={numColorComponents:4},t[36249]={numColorComponents:4},t[6402]={numColorComponents:1},t[34041]={numColorComponents:2}}const Xt={};function Yt(t,e){return Xt[e].bindPoint}function $t(t,e){return function(n){t.uniform1i(e,n)}}function Qt(t,e){return function(n){t.uniform1iv(e,n)}}function Zt(t,e){return function(n){t.uniform2iv(e,n)}}function Jt(t,e){return function(n){t.uniform3iv(e,n)}}function te(t,e){return function(n){t.uniform4iv(e,n)}}function ee(t,e,n,r){const i=Yt(0,e);return Wt(t)?function(e){let o,s;R(0,e)?(o=e,s=null):(o=e.texture,s=e.sampler),t.uniform1i(r,n),t.activeTexture(33984+n),t.bindTexture(i,o),t.bindSampler(n,s)}:function(e){t.uniform1i(r,n),t.activeTexture(33984+n),t.bindTexture(i,e)}}function ne(t,e,n,r,i){const o=Yt(0,e),s=new Int32Array(i);for(let t=0;t<i;++t)s[t]=n+t;return Wt(t)?function(e){t.uniform1iv(r,s),e.forEach((function(e,r){let i,a;t.activeTexture(33984+s[r]),R(0,e)?(i=e,a=null):(i=e.texture,a=e.sampler),t.bindSampler(n,a),t.bindTexture(o,i)}))}:function(e){t.uniform1iv(r,s),e.forEach((function(e,n){t.activeTexture(33984+s[n]),t.bindTexture(o,e)}))}}function re(t,e){return function(n){if(n.value)switch(t.disableVertexAttribArray(e),n.value.length){case 4:t.vertexAttrib4fv(e,n.value);break;case 3:t.vertexAttrib3fv(e,n.value);break;case 2:t.vertexAttrib2fv(e,n.value);break;case 1:t.vertexAttrib1fv(e,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else t.bindBuffer(34962,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,n.numComponents||n.size,n.type||5126,n.normalize||!1,n.stride||0,n.offset||0),void 0!==n.divisor&&t.vertexAttribDivisor(e,n.divisor)}}function ie(t,e){return function(n){if(n.value){if(t.disableVertexAttribArray(e),4!==n.value.length)throw new Error("The length of an integer constant value must be 4!");t.vertexAttrib4iv(e,n.value)}else t.bindBuffer(34962,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,n.numComponents||n.size,n.type||5124,n.stride||0,n.offset||0),void 0!==n.divisor&&t.vertexAttribDivisor(e,n.divisor)}}function oe(t,e){return function(n){if(n.value){if(t.disableVertexAttribArray(e),4!==n.value.length)throw new Error("The length of an unsigned integer constant value must be 4!");t.vertexAttrib4uiv(e,n.value)}else t.bindBuffer(34962,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,n.numComponents||n.size,n.type||5125,n.stride||0,n.offset||0),void 0!==n.divisor&&t.vertexAttribDivisor(e,n.divisor)}}function se(t,e,n){const r=n.size,i=n.count;return function(n){t.bindBuffer(34962,n.buffer);const o=n.size||n.numComponents||r,s=o/i,a=n.type||5126,l=Xt[a].size*o,u=n.normalize||!1,c=n.offset||0,h=l/i;for(let r=0;r<i;++r)t.enableVertexAttribArray(e+r),t.vertexAttribPointer(e+r,s,a,u,l,c+h*r),void 0!==n.divisor&&t.vertexAttribDivisor(e+r,n.divisor)}}Xt[5126]={Type:Float32Array,size:4,setter:function(t,e){return function(n){t.uniform1f(e,n)}},arraySetter:function(t,e){return function(n){t.uniform1fv(e,n)}}},Xt[35664]={Type:Float32Array,size:8,setter:function(t,e){return function(n){t.uniform2fv(e,n)}},cols:2},Xt[35665]={Type:Float32Array,size:12,setter:function(t,e){return function(n){t.uniform3fv(e,n)}},cols:3},Xt[35666]={Type:Float32Array,size:16,setter:function(t,e){return function(n){t.uniform4fv(e,n)}},cols:4},Xt[5124]={Type:Int32Array,size:4,setter:$t,arraySetter:Qt},Xt[35667]={Type:Int32Array,size:8,setter:Zt,cols:2},Xt[35668]={Type:Int32Array,size:12,setter:Jt,cols:3},Xt[35669]={Type:Int32Array,size:16,setter:te,cols:4},Xt[5125]={Type:Uint32Array,size:4,setter:function(t,e){return function(n){t.uniform1ui(e,n)}},arraySetter:function(t,e){return function(n){t.uniform1uiv(e,n)}}},Xt[36294]={Type:Uint32Array,size:8,setter:function(t,e){return function(n){t.uniform2uiv(e,n)}},cols:2},Xt[36295]={Type:Uint32Array,size:12,setter:function(t,e){return function(n){t.uniform3uiv(e,n)}},cols:3},Xt[36296]={Type:Uint32Array,size:16,setter:function(t,e){return function(n){t.uniform4uiv(e,n)}},cols:4},Xt[35670]={Type:Uint32Array,size:4,setter:$t,arraySetter:Qt},Xt[35671]={Type:Uint32Array,size:8,setter:Zt,cols:2},Xt[35672]={Type:Uint32Array,size:12,setter:Jt,cols:3},Xt[35673]={Type:Uint32Array,size:16,setter:te,cols:4},Xt[35674]={Type:Float32Array,size:32,setter:function(t,e){return function(n){t.uniformMatrix2fv(e,!1,n)}},rows:2,cols:2},Xt[35675]={Type:Float32Array,size:48,setter:function(t,e){return function(n){t.uniformMatrix3fv(e,!1,n)}},rows:3,cols:3},Xt[35676]={Type:Float32Array,size:64,setter:function(t,e){return function(n){t.uniformMatrix4fv(e,!1,n)}},rows:4,cols:4},Xt[35685]={Type:Float32Array,size:32,setter:function(t,e){return function(n){t.uniformMatrix2x3fv(e,!1,n)}},rows:2,cols:3},Xt[35686]={Type:Float32Array,size:32,setter:function(t,e){return function(n){t.uniformMatrix2x4fv(e,!1,n)}},rows:2,cols:4},Xt[35687]={Type:Float32Array,size:48,setter:function(t,e){return function(n){t.uniformMatrix3x2fv(e,!1,n)}},rows:3,cols:2},Xt[35688]={Type:Float32Array,size:48,setter:function(t,e){return function(n){t.uniformMatrix3x4fv(e,!1,n)}},rows:3,cols:4},Xt[35689]={Type:Float32Array,size:64,setter:function(t,e){return function(n){t.uniformMatrix4x2fv(e,!1,n)}},rows:4,cols:2},Xt[35690]={Type:Float32Array,size:64,setter:function(t,e){return function(n){t.uniformMatrix4x3fv(e,!1,n)}},rows:4,cols:3},Xt[35678]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:3553},Xt[35680]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:34067},Xt[35679]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:32879},Xt[35682]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:3553},Xt[36289]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:35866},Xt[36292]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:35866},Xt[36293]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:34067},Xt[36298]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:3553},Xt[36299]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:32879},Xt[36300]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:34067},Xt[36303]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:35866},Xt[36306]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:3553},Xt[36307]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:32879},Xt[36308]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:34067},Xt[36311]={Type:null,size:0,setter:ee,arraySetter:ne,bindPoint:35866};const ae={};ae[5126]={size:4,setter:re},ae[35664]={size:8,setter:re},ae[35665]={size:12,setter:re},ae[35666]={size:16,setter:re},ae[5124]={size:4,setter:ie},ae[35667]={size:8,setter:ie},ae[35668]={size:12,setter:ie},ae[35669]={size:16,setter:ie},ae[5125]={size:4,setter:oe},ae[36294]={size:8,setter:oe},ae[36295]={size:12,setter:oe},ae[36296]={size:16,setter:oe},ae[35670]={size:4,setter:ie},ae[35671]={size:8,setter:ie},ae[35672]={size:12,setter:ie},ae[35673]={size:16,setter:ie},ae[35674]={size:4,setter:se,count:2},ae[35675]={size:9,setter:se,count:3},ae[35676]={size:16,setter:se,count:4};const le={};le[34041]=33306,le[6401]=36128,le[36168]=36128,le[6402]=36096,le[33189]=36096,le[33190]=36096,le[36012]=36096,le[35056]=33306,le[36013]=33306;const ue={};ue[32854]=!0,ue[32855]=!0,ue[36194]=!0,ue[34041]=!0,ue[33189]=!0,ue[6401]=!0,ue[36168]=!0;var ce={};t(ce,"create",(function(){return dn})),t(ce,"identity",(function(){return pn})),t(ce,"setAxisAngle",(function(){return vn})),t(ce,"getAxisAngle",(function(){return fn})),t(ce,"getAngle",(function(){return mn})),t(ce,"dot",(function(){return Wn})),t(ce,"multiply",(function(){return bn})),t(ce,"rotateX",(function(){return _n})),t(ce,"rotateY",(function(){return gn})),t(ce,"rotateZ",(function(){return wn})),t(ce,"calculateW",(function(){return xn})),t(ce,"exp",(function(){return Cn})),t(ce,"ln",(function(){return En})),t(ce,"pow",(function(){return yn})),t(ce,"scale",(function(){return Gn})),t(ce,"slerp",(function(){return Pn})),t(ce,"random",(function(){return Tn})),t(ce,"invert",(function(){return Mn})),t(ce,"conjugate",(function(){return kn})),t(ce,"fromMat3",(function(){return An})),t(ce,"fromEuler",(function(){return Sn})),t(ce,"str",(function(){return Fn})),t(ce,"clone",(function(){return On})),t(ce,"fromValues",(function(){return Nn})),t(ce,"copy",(function(){return zn})),t(ce,"set",(function(){return jn})),t(ce,"add",(function(){return Hn})),t(ce,"mul",(function(){return Kn})),t(ce,"lerp",(function(){return qn})),t(ce,"length",(function(){return Xn})),t(ce,"len",(function(){return Yn})),t(ce,"squaredLength",(function(){return $n})),t(ce,"sqrLen",(function(){return Qn})),t(ce,"normalize",(function(){return Zn})),t(ce,"exactEquals",(function(){return Jn})),t(ce,"equals",(function(){return tr})),t(ce,"rotationTo",(function(){return er})),t(ce,"sqlerp",(function(){return nr})),t(ce,"setAxes",(function(){return rr}));var he="undefined"!=typeof Float32Array?Float32Array:Array,de=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var pe={};function ve(){var t=new he(3);return he!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function fe(t){var e=new he(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function me(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function be(t,e,n){var r=new he(3);return r[0]=t,r[1]=e,r[2]=n,r}function _e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ge(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function we(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function xe(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ce(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Ee(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function ye(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Pe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Te(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Me(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function ke(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Ae(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Se(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Fe(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function Re(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function Be(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Ve(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Le(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function De(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function Ue(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ie(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],l=n[2];return t[0]=i*l-o*a,t[1]=o*s-r*l,t[2]=r*a-i*s,t}function Oe(t,e,n,r){var i=e[0],o=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t}function Ne(t,e,n,r,i,o){var s=o*o,a=s*(2*o-3)+1,l=s*(o-2)+o,u=s*(o-1),c=s*(3-2*o);return t[0]=e[0]*a+n[0]*l+r[0]*u+i[0]*c,t[1]=e[1]*a+n[1]*l+r[1]*u+i[1]*c,t[2]=e[2]*a+n[2]*l+r[2]*u+i[2]*c,t}function ze(t,e,n,r,i,o){var s=1-o,a=s*s,l=o*o,u=a*s,c=3*o*a,h=3*l*s,d=l*o;return t[0]=e[0]*u+n[0]*c+r[0]*h+i[0]*d,t[1]=e[1]*u+n[1]*c+r[1]*h+i[1]*d,t[2]=e[2]*u+n[2]*c+r[2]*h+i[2]*d,t}function je(t,e){e=e||1;var n=2*de()*Math.PI,r=2*de()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function He(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t}function Ke(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function Ge(t,e,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],l=e[1],u=e[2],c=i*u-o*l,h=o*a-r*u,d=r*l-i*a,p=i*d-o*h,v=o*c-r*d,f=r*h-i*c,m=2*s;return c*=m,h*=m,d*=m,p*=2,v*=2,f*=2,t[0]=a+c+p,t[1]=l+h+v,t[2]=u+d+f,t}function We(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function qe(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Xe(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Ye(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2],l=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+s*s+a*a),u=l&&Ue(t,e)/l;return Math.acos(Math.min(Math.max(u,-1),1))}function $e(t){return t[0]=0,t[1]=0,t[2]=0,t}function Qe(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Ze(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Je(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2];return Math.abs(n-o)<=1e-6*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=1e-6*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=1e-6*Math.max(1,Math.abs(i),Math.abs(a))}t(pe,"create",(function(){return ve})),t(pe,"clone",(function(){return fe})),t(pe,"length",(function(){return me})),t(pe,"fromValues",(function(){return be})),t(pe,"copy",(function(){return _e})),t(pe,"set",(function(){return ge})),t(pe,"add",(function(){return we})),t(pe,"subtract",(function(){return xe})),t(pe,"multiply",(function(){return Ce})),t(pe,"divide",(function(){return Ee})),t(pe,"ceil",(function(){return ye})),t(pe,"floor",(function(){return Pe})),t(pe,"min",(function(){return Te})),t(pe,"max",(function(){return Me})),t(pe,"round",(function(){return ke})),t(pe,"scale",(function(){return Ae})),t(pe,"scaleAndAdd",(function(){return Se})),t(pe,"distance",(function(){return Fe})),t(pe,"squaredDistance",(function(){return Re})),t(pe,"squaredLength",(function(){return Be})),t(pe,"negate",(function(){return Ve})),t(pe,"inverse",(function(){return Le})),t(pe,"normalize",(function(){return De})),t(pe,"len",(function(){return an})),t(pe,"dot",(function(){return Ue})),t(pe,"cross",(function(){return Ie})),t(pe,"lerp",(function(){return Oe})),t(pe,"hermite",(function(){return Ne})),t(pe,"bezier",(function(){return ze})),t(pe,"random",(function(){return je})),t(pe,"transformMat4",(function(){return He})),t(pe,"transformMat3",(function(){return Ke})),t(pe,"transformQuat",(function(){return Ge})),t(pe,"rotateX",(function(){return We})),t(pe,"rotateY",(function(){return qe})),t(pe,"rotateZ",(function(){return Xe})),t(pe,"angle",(function(){return Ye})),t(pe,"zero",(function(){return $e})),t(pe,"str",(function(){return Qe})),t(pe,"exactEquals",(function(){return Ze})),t(pe,"equals",(function(){return Je})),t(pe,"sub",(function(){return en})),t(pe,"mul",(function(){return nn})),t(pe,"div",(function(){return rn})),t(pe,"dist",(function(){return on})),t(pe,"sqrDist",(function(){return sn})),t(pe,"sqrLen",(function(){return ln})),t(pe,"forEach",(function(){return un}));var tn,en=xe,nn=Ce,rn=Ee,on=Fe,sn=Re,an=me,ln=Be,un=(tn=ve(),function(t,e,n,r,i,o){var s,a;for(e||(e=3),n||(n=0),a=r?Math.min(r*e+n,t.length):t.length,s=n;s<a;s+=e)tn[0]=t[s],tn[1]=t[s+1],tn[2]=t[s+2],i(tn,tn,o),t[s]=tn[0],t[s+1]=tn[1],t[s+2]=tn[2];return t});function cn(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function hn(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}!function(){var t,e=(t=new he(4),he!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function dn(){var t=new he(4);return he!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function pn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function vn(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function fn(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>1e-6?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function mn(t,e){var n=Wn(t,e);return Math.acos(2*n*n-1)}function bn(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],l=n[1],u=n[2],c=n[3];return t[0]=r*c+s*a+i*u-o*l,t[1]=i*c+s*l+o*a-r*u,t[2]=o*c+s*u+r*l-i*a,t[3]=s*c-r*a-i*l-o*u,t}function _n(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+s*a,t[1]=i*l+o*a,t[2]=o*l-i*a,t[3]=s*l-r*a,t}function gn(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l-o*a,t[1]=i*l+s*a,t[2]=o*l+r*a,t[3]=s*l-i*a,t}function wn(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+i*a,t[1]=i*l-r*a,t[2]=o*l+s*a,t[3]=s*l-o*a,t}function xn(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Cn(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=Math.sqrt(n*n+r*r+i*i),a=Math.exp(o),l=s>0?a*Math.sin(s)/s:0;return t[0]=n*l,t[1]=r*l,t[2]=i*l,t[3]=a*Math.cos(s),t}function En(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=Math.sqrt(n*n+r*r+i*i),a=s>0?Math.atan2(s,o)/s:0;return t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=.5*Math.log(n*n+r*r+i*i+o*o),t}function yn(t,e,n){return En(t,e),Gn(t,t,n),Cn(t,t),t}function Pn(t,e,n,r){var i,o,s,a,l,u=e[0],c=e[1],h=e[2],d=e[3],p=n[0],v=n[1],f=n[2],m=n[3];return(o=u*p+c*v+h*f+d*m)<0&&(o=-o,p=-p,v=-v,f=-f,m=-m),1-o>1e-6?(i=Math.acos(o),s=Math.sin(i),a=Math.sin((1-r)*i)/s,l=Math.sin(r*i)/s):(a=1-r,l=r),t[0]=a*u+l*p,t[1]=a*c+l*v,t[2]=a*h+l*f,t[3]=a*d+l*m,t}function Tn(t){var e=de(),n=de(),r=de(),i=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*r),t[3]=o*Math.cos(2*Math.PI*r),t}function Mn(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=o*a,t}function kn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function An(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*s+s]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+s]-e[3*s+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[s]=(e[3*s+i]+e[3*i+s])*n}return t}function Sn(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),s=Math.cos(e),a=Math.sin(n),l=Math.cos(n),u=Math.sin(r),c=Math.cos(r);return t[0]=o*l*c-s*a*u,t[1]=s*a*c+o*l*u,t[2]=s*l*u-o*a*c,t[3]=s*l*c+o*a*u,t}function Fn(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Rn,Bn,Vn,Ln,Dn,Un,In,On=function(t){var e=new he(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},Nn=function(t,e,n,r){var i=new he(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i},zn=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},jn=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},Hn=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},Kn=bn,Gn=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},Wn=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},qn=function(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t[3]=a+r*(n[3]-a),t},Xn=cn,Yn=Xn,$n=hn,Qn=$n,Zn=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=o*s,t},Jn=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},tr=function(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],s=e[0],a=e[1],l=e[2],u=e[3];return Math.abs(n-s)<=1e-6*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=1e-6*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-l)<=1e-6*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-u)<=1e-6*Math.max(1,Math.abs(o),Math.abs(u))},er=(Rn=ve(),Bn=be(1,0,0),Vn=be(0,1,0),function(t,e,n){var r=Ue(e,n);return r<-.999999?(Ie(Rn,Bn,e),an(Rn)<1e-6&&Ie(Rn,Vn,e),De(Rn,Rn),vn(t,Rn,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Ie(Rn,e,n),t[0]=Rn[0],t[1]=Rn[1],t[2]=Rn[2],t[3]=1+r,Zn(t,t))}),nr=(Ln=dn(),Dn=dn(),function(t,e,n,r,i,o){return Pn(Ln,e,i,o),Pn(Dn,n,r,o),Pn(t,Ln,Dn,2*o*(1-o)),t}),rr=(Un=new he(9),he!=Float32Array&&(Un[1]=0,Un[2]=0,Un[3]=0,Un[5]=0,Un[6]=0,Un[7]=0),Un[0]=1,Un[4]=1,Un[8]=1,In=Un,function(t,e,n,r){return In[0]=n[0],In[3]=n[1],In[6]=n[2],In[1]=r[0],In[4]=r[1],In[7]=r[2],In[2]=-e[0],In[5]=-e[1],In[8]=-e[2],Zn(t,An(t,In))});var ir,or=new WeakSet,sr=new WeakSet,ar=new WeakSet,lr=new WeakSet,ur=new WeakSet,cr=new WeakSet,hr=new WeakSet,dr=new WeakSet,pr=new WeakSet,vr=new WeakSet,fr=new WeakSet,mr=new WeakSet,br=new WeakSet,_r=new WeakSet,gr=new WeakSet,wr=new WeakSet,xr=new WeakSet,Cr=new WeakSet;ir=new URL(o("kyEFX").resolve("iZtgb"),import.meta.url).toString();class Er{resize(){const t=this.gl;!function(t,e){e=e||1,e=Math.max(0,e);const n=t.clientWidth*e|0,r=t.clientHeight*e|0;(t.width!==n||t.height!==r)&&(t.width=n,t.height=r)}(t.canvas),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),u(this,_r,zr).call(this,t),u(this,wr,Hr).call(this,t)}run(t=0){l(this,Tr,t-a(this,yr)),l(this,yr,t),l(this,Pr,a(this,Pr)+a(this,Tr)/16),a(this,Mr)||(u(this,hr,Vr).call(this),this.drawUniforms.u_deltaTime=a(this,Tr),this.drawUniforms.u_worldInverseTransposeMatrix=M.transpose(M.inverse(this.drawUniforms.u_worldMatrix)),this.instanceMatrices.forEach(((t,e)=>{const n=this.instances[e],r=M.identity();M.translate(r,n.translation,r),M.rotateX(r,n.rotation[0]+a(this,Pr)*n.rotationSpeed*.5,r),M.rotateY(r,n.rotation[1]+a(this,Pr)*n.rotationSpeed,r),M.rotateZ(r,n.rotation[2],r),M.scale(r,n.scale,t)})),u(this,or,kr).call(this),requestAnimationFrame((t=>this.run(t))))}destroy(){l(this,Mr,!0)}initEnvMap(){const t=this.gl;this.envMapTexture=u(this,br,Nr).call(this,t,t.LINEAR,t.LINEAR),t.bindTexture(t.TEXTURE_2D,this.envMapTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,2e3,1e3,0,t.RGBA,t.UNSIGNED_BYTE,null);const e=new Image;e.src=new URL(ir),e.addEventListener("load",(()=>{t.bindTexture(t.TEXTURE_2D,this.envMapTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,2e3,1e3,0,t.RGBA,t.UNSIGNED_BYTE,e)}))}constructor(t,e,n=null){c(this,"oninit",void 0),yr.set(this,{writable:!0,value:0}),Pr.set(this,{writable:!0,value:0}),Tr.set(this,{writable:!0,value:0}),Mr.set(this,{writable:!0,value:!1}),c(this,"enableRegionsPreview",!1),c(this,"enableFarMidPreview",!1),c(this,"enableNearPreview",!1),c(this,"enablePackedPreview",!1),c(this,"enableCoCPreview",!1),c(this,"passPreviewSize",1),c(this,"DOF_TEXTURE_SCALE",.5),c(this,"COMPOSITE_RESULT",0),c(this,"COMPOSITE_REGIONS",1),c(this,"COMPOSITE_NEAR_FIELD",2),c(this,"COMPOSITE_FAR_FIELD",3),c(this,"COMPOSITE_PACKED",4),c(this,"COMPOSITE_COC",5),c(this,"camera",{matrix:M.identity(),near:1,far:500,orbit:ce.create(),up:pe.fromValues(0,1,0),distance:150,position:pe.fromValues(0,0,150),rotation:[0,0,0]}),c(this,"dof",{nearBlurry:40,nearSharp:110,farSharp:130,farBlurry:240,maxCoCRadius:15,radiusScale:2}),c(this,"instances",[]),or.add(this),sr.add(this),ar.add(this),lr.add(this),ur.add(this),cr.add(this),hr.add(this),dr.add(this),pr.add(this),vr.add(this),fr.add(this),mr.add(this),br.add(this),_r.add(this),gr.add(this),wr.add(this),xr.add(this),Cr.add(this),this.canvas=t,this.pane=e,this.oninit=n,u(this,ur,Rr).call(this)}}var yr=new WeakMap,Pr=new WeakMap,Tr=new WeakMap,Mr=new WeakMap;function kr(){const t=this.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.enable(t.DEPTH_TEST),t.enable(t.CULL_FACE),u(this,mr,Or).call(this,t,this.drawFramebuffer,this.drawFramebufferWidth,this.drawFramebufferHeight),t.useProgram(this.drawProgram),t.bindVertexArray(this.objectVAO),t.bindBuffer(t.ARRAY_BUFFER,this.matrixBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.instanceMatricesArray),t.uniformMatrix4fv(this.drawLocations.u_worldMatrix,!1,this.drawUniforms.u_worldMatrix),t.uniformMatrix4fv(this.drawLocations.u_viewMatrix,!1,this.drawUniforms.u_viewMatrix),t.uniformMatrix4fv(this.drawLocations.u_projectionMatrix,!1,this.drawUniforms.u_projectionMatrix),t.uniformMatrix4fv(this.drawLocations.u_worldInverseTransposeMatrix,!1,this.drawUniforms.u_worldInverseTransposeMatrix),t.uniform3f(this.drawLocations.u_cameraPosition,this.camera.position[0],this.camera.position[1],this.camera.position[2]),t.uniform1i(this.drawLocations.u_envMap,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.envMapTexture),t.clearBufferfv(t.COLOR,0,[1,.3,.5,0]),t.clearBufferfv(t.DEPTH,0,[1]),t.drawElementsInstanced(t.TRIANGLES,this.objectBuffers.numElements,t.UNSIGNED_SHORT,0,this.numInstances),u(this,mr,Or).call(this,t,null,t.drawingBufferWidth,t.drawingBufferHeight),t.bindFramebuffer(t.READ_FRAMEBUFFER,this.drawFramebuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this.blitFramebuffer),t.clearBufferfv(t.COLOR,0,[0,0,0,1]),t.clearBufferfv(t.DEPTH,0,[0]),t.blitFramebuffer(0,0,this.drawFramebufferWidth,this.drawFramebufferHeight,0,0,this.drawFramebufferWidth,this.drawFramebufferHeight,t.COLOR_BUFFER_BIT,t.NEAREST),t.blitFramebuffer(0,0,this.drawFramebufferWidth,this.drawFramebufferHeight,0,0,this.drawFramebufferWidth,this.drawFramebufferHeight,t.DEPTH_BUFFER_BIT,t.NEAREST),u(this,mr,Or).call(this,t,null,t.drawingBufferWidth,t.drawingBufferHeight),u(this,sr,Ar).call(this,this.dofPackedFramebuffer,this.drawFramebufferWidth,this.drawFramebufferHeight,this.dofPackProgram,[[this.dofPackLocations.u_depth,this.depthTexture],[this.dofPackLocations.u_color,this.colorTexture]],[[this.dofPackLocations.u_nearBlurry,this.dof.nearBlurry],[this.dofPackLocations.u_nearSharp,this.dof.nearSharp],[this.dofPackLocations.u_farBlurry,this.dof.farBlurry],[this.dofPackLocations.u_farSharp,this.dof.farSharp],[this.dofPackLocations.u_zNear,this.camera.near],[this.dofPackLocations.u_zFar,this.camera.far]]),u(this,sr,Ar).call(this,this.dofBlurHFramebuffer,this.dofFramebufferWidth,this.dofFramebufferHeight,this.dofBlurHProgram,[[this.dofBlurHLocations.u_packedTexture,this.dofPackedTexture]],[,[this.dofBlurHLocations.u_radiusScale,this.dof.radiusScale]],[[this.dofBlurHLocations.u_maxCoCRadius,this.dof.maxCoCRadius]]),u(this,sr,Ar).call(this,this.dofBlurVFramebuffer,this.dofFramebufferWidth,this.dofFramebufferHeight,this.dofBlurVProgram,[[this.dofBlurVLocations.u_midFarBlurTexture,this.dofBlurHMidFarTexture],[this.dofBlurVLocations.u_nearBlurTexture,this.dofBlurHNearTexture]],[[this.dofBlurVLocations.u_radiusScale,this.dof.radiusScale]],[[this.dofBlurVLocations.u_maxCoCRadius,this.dof.maxCoCRadius]]),u(this,lr,Fr).call(this,this.COMPOSITE_RESULT);let e=0;this.enableRegionsPreview&&(e=u(this,ar,Sr).call(this,0,this.COMPOSITE_REGIONS)),this.enableFarMidPreview&&(e=u(this,ar,Sr).call(this,e,this.COMPOSITE_FAR_FIELD)),this.enableNearPreview&&(e=u(this,ar,Sr).call(this,e,this.COMPOSITE_NEAR_FIELD)),this.enablePackedPreview&&(e=u(this,ar,Sr).call(this,e,this.COMPOSITE_PACKED)),this.enableCoCPreview&&(e=u(this,ar,Sr).call(this,e,this.COMPOSITE_COC))}function Ar(t,e,n,r,i,o=[],s=[]){const a=this.gl;u(this,mr,Or).call(this,a,t,e,n),a.useProgram(r),a.clearColor(0,0,0,1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.bindVertexArray(this.quadVAO),i.forEach((([t,e],n)=>{a.uniform1i(t,n),a.activeTexture(a[`TEXTURE${n}`]),a.bindTexture(a.TEXTURE_2D,e)})),o.forEach((([t,e])=>{a.uniform1f(t,e)})),s.forEach((([t,e])=>{a.uniform1i(t,e)})),a.drawElements(a.TRIANGLES,this.quadBuffers.numElements,a.UNSIGNED_SHORT,0),u(this,mr,Or).call(this,a,null,a.drawingBufferWidth,a.drawingBufferHeight)}function Sr(t=0,e=0){const n=this.gl,r=n.canvas.width*this.passPreviewSize,i=n.canvas.height*this.passPreviewSize;return n.enable(n.SCISSOR_TEST),n.scissor(0,t,r,i),n.viewport(0,t,r,i),u(this,lr,Fr).call(this,e),n.disable(n.SCISSOR_TEST),t+i}function Fr(t=0){const e=this.gl;e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.useProgram(this.dofCompositeProgram),e.bindVertexArray(this.quadVAO),e.uniform1i(this.dofCompositeLocations.u_packedTexture,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.dofPackedTexture),e.uniform1i(this.dofCompositeLocations.u_midFarBlurTexture,1),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this.dofBlurVMidFarTexture),e.uniform1i(this.dofCompositeLocations.u_nearBlurTexture,2),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,this.dofBlurVNearTexture),e.uniform1i(this.dofCompositeLocations.u_sourceColorTexture,3),e.activeTexture(e.TEXTURE3),e.bindTexture(e.TEXTURE_2D,this.colorTexture),e.uniform1i(this.dofCompositeLocations.u_passIndex,t),e.drawElements(e.TRIANGLES,this.quadBuffers.numElements,e.UNSIGNED_SHORT,0)}function Rr(){this.gl=this.canvas.getContext("webgl2",{antialias:!1,alpha:!1});const t=this.gl;if(!t)throw new Error("No WebGL 2 context!");this.drawProgram=u(this,fr,Ir).call(this,t,[e("#version 300 es\n#define GLSLIFY 1\n\nuniform mat4 u_worldMatrix;\nuniform mat4 u_viewMatrix;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_worldInverseTransposeMatrix;\nuniform vec3 u_cameraPosition;\n\nin vec3 a_position;\nin vec3 a_normal;\nin vec2 a_uv;\nin mat4 a_instanceMatrix;\n\nflat out vec3 v_normal;\nout vec2 v_uv;\nout vec3 v_surfaceToView;\n\nvoid main() {\n    v_uv = a_uv;\n    v_normal = (a_instanceMatrix * u_worldInverseTransposeMatrix * vec4(a_normal, 0.)).xyz;\n    vec4 worldPosition = a_instanceMatrix * u_worldMatrix * vec4(a_position, 1.);\n    gl_Position = u_projectionMatrix * u_viewMatrix * worldPosition;\n    v_surfaceToView = u_cameraPosition - worldPosition.xyz;\n}\n"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_envMap;\nuniform float u_deltaTime;\n\nflat in vec3 v_normal;\nin vec2 v_uv;\nin vec3 v_surfaceToView;\n\nout vec4 outColor;\n\n#define PI 3.1415926535\n\nvec2 directionToEquirectangular(vec3 d) {\n    vec2 p = vec2(0.);\n    vec3 n = normalize(d);\n\n    p.x = acos(n.y);\n\n    d.y = 0.0;\n    n = normalize(d);\n    \n    if(n.x >= 0.)\n        p.y = acos(-n.z);\n    else    \n        p.y = acos(n.z) + PI;\n\n    return p;\n}\n\nvoid main() {\n    //vec3 r = reflect(normalize(v_surfaceToView), normalize(-v_normal));\n    vec3 n = normalize(v_normal);\n    vec3 v = normalize(v_surfaceToView);\n    float nDv = dot(n, v);\n    vec3 r = nDv * n * 2. - v;\n\n    // Convert Cartesian direction vector to spherical coordinates.\n\tfloat phi   = atan(r.z, r.x);\n\tfloat theta = acos(r.y);\n    vec2 equiPos = vec2(phi / (2. * PI), theta / PI);\n\n\t// Sample equirectangular texture.\n    vec4 envMapColor = texture(u_envMap, equiPos);\n\n    float fog = smoothstep(100., 300., length(v_surfaceToView));\n\n    float fresnel = 1. - smoothstep(0.4, .7, nDv);\n\n    outColor = envMapColor + (fog * vec4(1.0, 0.4, 0.6, 1.));\n    outColor *= fresnel;\n    outColor = clamp(vec4(0.), vec4(1.), pow(outColor, vec4(1.2)));\n}\n")],null,{a_position:0,a_normal:1,a_uv:2,a_instanceMatrix:4}),this.dofPackProgram=u(this,fr,Ir).call(this,t,[e("#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    gl_Position = vec4(a_position, 0., 1.);\n}"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_depth;\nuniform sampler2D u_color;\nuniform float u_nearBlurry;\nuniform float u_nearSharp;\nuniform float u_farBlurry;\nuniform float u_farSharp;\nuniform float u_zNear;\nuniform float u_zFar;\n\nin vec2 v_uv;\n\nout vec4 packed;\n\nfloat zFromDepth(float depth, float zNear, float zFar) {\n    float d = 2. * depth - 1.;\n    return (2. * zNear * zFar) / (zFar + zNear - d * (zFar - zNear));\n}\n\nvoid main() {\n    float tmp = u_nearBlurry + u_nearSharp + u_farBlurry + u_farSharp;\n\n    vec4 color = texture(u_color, v_uv);\n\n    // the non-linear depth value [0, 1]\n    float depth = texture(u_depth, v_uv).x;\n\n    // the reconstructed z-value in view space\n    float z = zFromDepth(depth, u_zNear, u_zFar);\n\n    // percent of the maximal CoC [1, -1]\n    float radius = 1.;\n\n    if (z < u_nearSharp) {\n        radius = 1. - (max(z, u_nearBlurry) - u_nearBlurry) / (u_nearSharp - u_nearBlurry);\n    } else if (z > u_farSharp) {\n        radius = - (min(z, u_farBlurry) - u_farSharp) / (u_farBlurry - u_farSharp);\n    } else {\n        radius = 0.;\n    }\n\n    radius = radius * .5 + .5;\n\n    packed = vec4(color.rgb, radius);\n}\n")],null,{a_position:0,a_uv:1}),this.dofBlurHProgram=u(this,fr,Ir).call(this,t,[e("#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    gl_Position = vec4(a_position, 0., 1.);\n}"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_packedTexture;\nuniform int u_maxCoCRadius;\nuniform float u_radiusScale;\n\nin vec2 v_uv;\n\nlayout(location = 0) out vec4 outMidFarColor;\nlayout(location = 1) out vec4 outNearColor;\n\nbool inNearField(float radiusPixels) {\n    return radiusPixels > 0.25;\n}\n\nvoid depthOfFieldBlur(\n    in bool isHorizontal,\n    in vec2 A,\n    in int maxCoCRadius,\n    in float radiusScale,\n    in sampler2D midFarInTexture,\n    in sampler2D nearInTexture,\n    out vec4 midFarOut,\n    out vec4 nearOut\n) {\n    // the resulting g-buffer values\n    vec4 midFarResult = vec4(0.);\n    vec4 nearResult = vec4(0.);\n\n    const int GAUSSIAN_TAPS = 6;\n    float gaussian[GAUSSIAN_TAPS + 1];  \n    // gaussian weights\n    gaussian[6] = 0.00000000000000;\n    gaussian[5] = 0.04153263993208;\n    gaussian[4] = 0.06352050813141;\n    gaussian[3] = 0.08822292796029;\n    gaussian[2] = 0.11143948794984;\n    gaussian[1] = 0.12815541114232;\n    gaussian[0] = 0.13425804976814;\n\n    // position of the current pixel\n    vec2 texelSize = 1. / vec2(textureSize(midFarInTexture, 0));\n    vec4 packedA = texture(midFarInTexture, A);\n    float radiusA = (packedA.a * 2. - 1.);\n    float rA = radiusA * float(maxCoCRadius);\n\n    float midFarWeightSum = 0.;\n    float nearWeightSum = 0.;\n\n    // rapidly goes to 1 when within the near field\n    float nearFieldnessA = clamp(radiusA * 2.0, 0., 1.);\n\n    vec2 direction = vec2(float(isHorizontal), float(!isHorizontal));\n\n    // the blur renders with half of the full resolution (see DOF_TEXTURE_SCALE in app)\n    // this has to be compensated during the blur\n    texelSize /= float(!isHorizontal) + 1.;\n\n    // scatter as you gather loop\n    for(int delta = -maxCoCRadius; delta <= maxCoCRadius; ++delta) {\n\n        // get the CoC radius at this tap\n        vec2 B = A + direction * (float(delta) * radiusScale * texelSize);\n        vec4 packedB = texture(midFarInTexture, B);\n        float rB = (packedB.a * 2. - 1.) * float(maxCoCRadius);\n\n        ///////////////////////////////////////////////////// Mid/Far Field\n\n        // mid/far field: B nearer then A weight\n        float midFarBNearerWeight = clamp(abs(rA) - abs(rB) + 1.5, 0., 1.);\n\n        // get the effect of the CoC at B on the current pixel at A\n        float gaussianWeight = gaussian[clamp(int(float(abs(delta) * (GAUSSIAN_TAPS - 1)) / (0.001 + abs(rB * 0.5))), 0, GAUSSIAN_TAPS)];\n\n        // get the weight for mid and far field values\n        float midFarWeight = float(!inNearField(rB)) * midFarBNearerWeight * gaussianWeight;\n\n        // also blur the near field of the mid far color for composition\n        midFarWeight = mix(midFarWeight, 1., nearFieldnessA);\n\n        // update the mid/far result\n        midFarWeightSum += midFarWeight;\n        midFarResult.rgb += packedB.rgb * midFarWeight;\n\n        ///////////////////////////////////////////////////// Near Field\n\n        // the near field value at this tap\n        vec4 near;\n\n        if (isHorizontal) {\n            // the current tap contributes to the near field coverage\n            float hasNearFieldCoverage = float(abs(float(delta)) <= rB);\n\n            // rapidly move the coverage when tap contributes to the current pixel in near field\n            near.a = hasNearFieldCoverage * clamp((rB / float(maxCoCRadius)) * 4., 0., 1.);\n            near.a *= near.a;\n            near.a *= near.a;\n\n            // premultiplied color\n            near.rgb = packedB.rgb * near.a;\n        } else {\n            near = texture(nearInTexture, B);\n        }\n\n        // simple box blur for the near field\n        float nearWeight = 1.;\n        nearResult += near * nearWeight;\n        nearWeightSum += nearWeight;\n    }\n\n    if (isHorizontal) {\n        // forward the normalized CoC to the next pass\n        midFarResult.a = packedA.a;\n    } else {\n        midFarResult.a = 1.;\n    }\n\n    // apply total weights\n    midFarResult.rgb /= midFarWeightSum;\n    nearResult /= nearWeightSum;\n\n    nearOut = nearResult;\n    midFarOut = midFarResult;\n}\n\nvoid main() {\n    depthOfFieldBlur(\n        true,\n        v_uv,\n        u_maxCoCRadius,\n        u_radiusScale,\n        u_packedTexture,\n        u_packedTexture, // not used in horizontal pass\n        outMidFarColor,\n        outNearColor\n    );\n}")],null,{a_position:0,a_uv:1}),this.dofBlurVProgram=u(this,fr,Ir).call(this,t,[e("#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    gl_Position = vec4(a_position, 0., 1.);\n}"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_midFarBlurTexture;\nuniform sampler2D u_nearBlurTexture;\nuniform int u_maxCoCRadius;\nuniform float u_radiusScale;\n\nin vec2 v_uv;\n\nlayout(location = 0) out vec4 outMidFarColor;\nlayout(location = 1) out vec4 outNearColor;\n\nbool inNearField(float radiusPixels) {\n    return radiusPixels > 0.25;\n}\n\nvoid depthOfFieldBlur(\n    in bool isHorizontal,\n    in vec2 A,\n    in int maxCoCRadius,\n    in float radiusScale,\n    in sampler2D midFarInTexture,\n    in sampler2D nearInTexture,\n    out vec4 midFarOut,\n    out vec4 nearOut\n) {\n    // the resulting g-buffer values\n    vec4 midFarResult = vec4(0.);\n    vec4 nearResult = vec4(0.);\n\n    const int GAUSSIAN_TAPS = 6;\n    float gaussian[GAUSSIAN_TAPS + 1];  \n    // gaussian weights\n    gaussian[6] = 0.00000000000000;\n    gaussian[5] = 0.04153263993208;\n    gaussian[4] = 0.06352050813141;\n    gaussian[3] = 0.08822292796029;\n    gaussian[2] = 0.11143948794984;\n    gaussian[1] = 0.12815541114232;\n    gaussian[0] = 0.13425804976814;\n\n    // position of the current pixel\n    vec2 texelSize = 1. / vec2(textureSize(midFarInTexture, 0));\n    vec4 packedA = texture(midFarInTexture, A);\n    float radiusA = (packedA.a * 2. - 1.);\n    float rA = radiusA * float(maxCoCRadius);\n\n    float midFarWeightSum = 0.;\n    float nearWeightSum = 0.;\n\n    // rapidly goes to 1 when within the near field\n    float nearFieldnessA = clamp(radiusA * 2.0, 0., 1.);\n\n    vec2 direction = vec2(float(isHorizontal), float(!isHorizontal));\n\n    // the blur renders with half of the full resolution (see DOF_TEXTURE_SCALE in app)\n    // this has to be compensated during the blur\n    texelSize /= float(!isHorizontal) + 1.;\n\n    // scatter as you gather loop\n    for(int delta = -maxCoCRadius; delta <= maxCoCRadius; ++delta) {\n\n        // get the CoC radius at this tap\n        vec2 B = A + direction * (float(delta) * radiusScale * texelSize);\n        vec4 packedB = texture(midFarInTexture, B);\n        float rB = (packedB.a * 2. - 1.) * float(maxCoCRadius);\n\n        ///////////////////////////////////////////////////// Mid/Far Field\n\n        // mid/far field: B nearer then A weight\n        float midFarBNearerWeight = clamp(abs(rA) - abs(rB) + 1.5, 0., 1.);\n\n        // get the effect of the CoC at B on the current pixel at A\n        float gaussianWeight = gaussian[clamp(int(float(abs(delta) * (GAUSSIAN_TAPS - 1)) / (0.001 + abs(rB * 0.5))), 0, GAUSSIAN_TAPS)];\n\n        // get the weight for mid and far field values\n        float midFarWeight = float(!inNearField(rB)) * midFarBNearerWeight * gaussianWeight;\n\n        // also blur the near field of the mid far color for composition\n        midFarWeight = mix(midFarWeight, 1., nearFieldnessA);\n\n        // update the mid/far result\n        midFarWeightSum += midFarWeight;\n        midFarResult.rgb += packedB.rgb * midFarWeight;\n\n        ///////////////////////////////////////////////////// Near Field\n\n        // the near field value at this tap\n        vec4 near;\n\n        if (isHorizontal) {\n            // the current tap contributes to the near field coverage\n            float hasNearFieldCoverage = float(abs(float(delta)) <= rB);\n\n            // rapidly move the coverage when tap contributes to the current pixel in near field\n            near.a = hasNearFieldCoverage * clamp((rB / float(maxCoCRadius)) * 4., 0., 1.);\n            near.a *= near.a;\n            near.a *= near.a;\n\n            // premultiplied color\n            near.rgb = packedB.rgb * near.a;\n        } else {\n            near = texture(nearInTexture, B);\n        }\n\n        // simple box blur for the near field\n        float nearWeight = 1.;\n        nearResult += near * nearWeight;\n        nearWeightSum += nearWeight;\n    }\n\n    if (isHorizontal) {\n        // forward the normalized CoC to the next pass\n        midFarResult.a = packedA.a;\n    } else {\n        midFarResult.a = 1.;\n    }\n\n    // apply total weights\n    midFarResult.rgb /= midFarWeightSum;\n    nearResult /= nearWeightSum;\n\n    nearOut = nearResult;\n    midFarOut = midFarResult;\n}\n\nvoid main() {\n    depthOfFieldBlur(\n        false,\n        v_uv,\n        u_maxCoCRadius,\n        u_radiusScale,\n        u_midFarBlurTexture,\n        u_nearBlurTexture,\n        outMidFarColor,\n        outNearColor\n    );\n}")],null,{a_position:0,a_uv:1}),this.dofCompositeProgram=u(this,fr,Ir).call(this,t,[e("#version 300 es\n#define GLSLIFY 1\n\nin vec2 a_position;\nin vec2 a_uv;\n\nout vec2 v_uv;\n\nvoid main() {\n    v_uv = a_uv;\n    gl_Position = vec4(a_position, 0., 1.);\n}"),e("#version 300 es\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D u_sourceColorTexture;\nuniform sampler2D u_packedTexture;\nuniform sampler2D u_midFarBlurTexture;\nuniform sampler2D u_nearBlurTexture;\nuniform int u_passIndex;\n\nin vec2 v_uv;\n\nout vec4 compositeColor;\n\nfloat grayscale(vec3 c) {\n    return (c.r + c.g + c.b) / 3.0;\n}\n\nvoid main() {\n    const int COMPOSITE_RESULT       = 0;\n    const int COMPOSITE_REGIONS      = 1;\n    const int COMPOSITE_NEAR_FIELD   = 2;\n    const int COMPOSITE_FAR_FIELD    = 3;\n    const int COMPOSITE_PACKED       = 4;\n    const int COMPOSITE_COC          = 5;\n    \n    vec4 sourceColor = texture(u_sourceColorTexture, v_uv);\n    vec4 packedColor = texture(u_packedTexture, v_uv);\n    vec4 midFarBlurColor = texture(u_midFarBlurTexture, v_uv);\n    vec4 nearBlurColor = texture(u_nearBlurTexture, v_uv);\n\n    // find the normalized CoC\n    vec2 texelSize = 1. / vec2(textureSize(u_packedTexture, 0)); \n    float normCoCRadius = (packedColor.a * 2. - 1.);\n\n    // boost the coverage of near field\n    float nearCoverageBoost = 4.;\n    float a = clamp(0., 1., nearCoverageBoost * nearBlurColor.a);\n    nearBlurColor.rgb = nearBlurColor.rgb * (a / max(nearBlurColor.a, 0.001));\n    nearBlurColor.a = a;\n\n    // increase influence of the near field\n    if (normCoCRadius > 0.1) {\n        normCoCRadius = min(normCoCRadius * 1.4, 1.0);\n    }\n\n    // mix the blurred near and mid/far with the original image\n    compositeColor = mix(sourceColor, midFarBlurColor, abs(normCoCRadius)) * (1. - nearBlurColor.a) + nearBlurColor;\n\n    switch(u_passIndex) {\n        case COMPOSITE_REGIONS:\n            float radius = packedColor.a;\n            float gray = grayscale(packedColor.rgb);\n            gray = packedColor.a * 2.;\n            vec3 midColor = vec3(.3) * gray;\n            compositeColor = vec4(1.);\n\n            if (radius > 0.51) {\n                // near field\n                float strength = (radius - 0.5) * 2.;\n                compositeColor.rgb = strength * vec3(0.0, 0.5, 1.) * vec3(gray) + (1. - strength) * midColor;\n            } else if (radius >= 0.49) {\n                // mid field\n                compositeColor.rgb = midColor;\n            } else {\n                // far field\n                float strength = (.5 - radius) * 2.;\n                compositeColor.rgb = strength * vec3(1.0, 0.1, 0.1) * vec3(gray) + (1. - strength) * midColor;\n            }\n            break;\n        case COMPOSITE_COC:\n            compositeColor = vec4(packedColor.a);\n            break;\n        case COMPOSITE_NEAR_FIELD:\n            compositeColor = nearBlurColor;\n            break;\n        case COMPOSITE_FAR_FIELD:\n            compositeColor = midFarBlurColor;\n            break;\n        case COMPOSITE_PACKED:\n            compositeColor = packedColor;\n        default:\n            compositeColor = compositeColor;\n    }\n}")],null,{a_position:0,a_uv:1}),this.drawLocations={a_position:t.getAttribLocation(this.drawProgram,"a_position"),a_normal:t.getAttribLocation(this.drawProgram,"a_normal"),a_uv:t.getAttribLocation(this.drawProgram,"a_uv"),a_instanceMatrix:t.getAttribLocation(this.drawProgram,"a_instanceMatrix"),u_worldMatrix:t.getUniformLocation(this.drawProgram,"u_worldMatrix"),u_viewMatrix:t.getUniformLocation(this.drawProgram,"u_viewMatrix"),u_projectionMatrix:t.getUniformLocation(this.drawProgram,"u_projectionMatrix"),u_worldInverseTransposeMatrix:t.getUniformLocation(this.drawProgram,"u_worldInverseTransposeMatrix"),u_envMap:t.getUniformLocation(this.drawProgram,"u_envMap"),u_cameraPosition:t.getUniformLocation(this.drawProgram,"u_cameraPosition")},this.dofPackLocations={a_position:t.getAttribLocation(this.dofPackProgram,"a_position"),a_uv:t.getAttribLocation(this.dofPackProgram,"a_uv"),u_depth:t.getUniformLocation(this.dofPackProgram,"u_depth"),u_color:t.getUniformLocation(this.dofPackProgram,"u_color"),u_nearBlurry:t.getUniformLocation(this.dofPackProgram,"u_nearBlurry"),u_nearSharp:t.getUniformLocation(this.dofPackProgram,"u_nearSharp"),u_farBlurry:t.getUniformLocation(this.dofPackProgram,"u_farBlurry"),u_farSharp:t.getUniformLocation(this.dofPackProgram,"u_farSharp"),u_zNear:t.getUniformLocation(this.dofPackProgram,"u_zNear"),u_zFar:t.getUniformLocation(this.dofPackProgram,"u_zFar")},this.dofBlurHLocations={a_position:t.getAttribLocation(this.dofBlurHProgram,"a_position"),a_uv:t.getAttribLocation(this.dofBlurHProgram,"a_uv"),u_packedTexture:t.getUniformLocation(this.dofBlurHProgram,"u_packedTexture"),u_maxCoCRadius:t.getUniformLocation(this.dofBlurHProgram,"u_maxCoCRadius"),u_radiusScale:t.getUniformLocation(this.dofBlurHProgram,"u_radiusScale")},this.dofBlurVLocations={a_position:t.getAttribLocation(this.dofBlurVProgram,"a_position"),a_uv:t.getAttribLocation(this.dofBlurVProgram,"a_uv"),u_midFarBlurTexture:t.getUniformLocation(this.dofBlurVProgram,"u_midFarBlurTexture"),u_nearBlurTexture:t.getUniformLocation(this.dofBlurVProgram,"u_nearBlurTexture"),u_maxCoCRadius:t.getUniformLocation(this.dofBlurVProgram,"u_maxCoCRadius"),u_radiusScale:t.getUniformLocation(this.dofBlurVProgram,"u_radiusScale")},this.dofCompositeLocations={a_position:t.getAttribLocation(this.dofCompositeProgram,"a_position"),a_uv:t.getAttribLocation(this.dofCompositeProgram,"a_uv"),u_packedTexture:t.getUniformLocation(this.dofCompositeProgram,"u_packedTexture"),u_midFarBlurTexture:t.getUniformLocation(this.dofCompositeProgram,"u_midFarBlurTexture"),u_nearBlurTexture:t.getUniformLocation(this.dofCompositeProgram,"u_nearBlurTexture"),u_passIndex:t.getUniformLocation(this.dofCompositeProgram,"u_passIndex"),u_sourceColorTexture:t.getUniformLocation(this.dofCompositeProgram,"u_sourceColorTexture")},this.drawUniforms={u_worldMatrix:M.translate(M.scaling([13,13,13]),[0,0,0]),u_viewMatrix:M.identity(),u_projectionMatrix:M.identity(),u_worldInverseTransposeMatrix:M.identity()},this.objectBuffers=Gt.createTorusBuffers(t,1.7,.25,64,16),this.objectVAO=u(this,pr,Dr).call(this,t,[[this.objectBuffers.position,this.drawLocations.a_position,3],[this.objectBuffers.normal,this.drawLocations.a_normal,3],[this.objectBuffers.texcoord,this.drawLocations.a_uv,2]],this.objectBuffers.indices),this.quadBuffers=Gt.createXYQuadBuffers(t),this.quadVAO=u(this,pr,Dr).call(this,t,[[this.quadBuffers.position,this.dofPackLocations.a_position,2],[this.quadBuffers.texcoord,this.dofPackLocations.a_uv,2]],this.quadBuffers.indices),t.bindVertexArray(this.objectVAO),this.gridSize=2,this.numInstances=this.gridSize*this.gridSize*this.gridSize,this.instanceMatricesArray=new Float32Array(16*this.numInstances),this.instanceMatrices=[];const n=this.gridSize*this.gridSize,r=80,i=Math.floor(this.gridSize/2),o=r/1.5;for(let t=0;t<this.numInstances;++t){const e=t%this.gridSize-i,s=Math.floor(t/n)-i,a=Math.floor(t%n/this.gridSize)-i,l=M.translation([e*r,a*r,s*r]),u=new Float32Array(this.instanceMatricesArray.buffer,64*t,16);u.set(l),this.instanceMatrices.push(u);const c=3*(Math.random()+.5);this.instances.push({translation:[e*r+(Math.random()*o-o/2),a*r+(Math.random()*o-o/2),s*r+(Math.random()*o-o/2)],scale:[c,c,c],rotation:[Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2],rotationSpeed:.001*(2*Math.random()-1)})}this.matrixBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.matrixBuffer),t.bufferData(t.ARRAY_BUFFER,this.instanceMatricesArray.byteLength,t.DYNAMIC_DRAW);for(let e=0;e<4;++e){const n=this.drawLocations.a_instanceMatrix+e;t.enableVertexAttribArray(n),t.vertexAttribPointer(n,4,t.FLOAT,!1,64,16*e),t.vertexAttribDivisor(n,1)}t.bindVertexArray(null);const s=t.canvas.clientWidth,a=t.canvas.clientHeight;this.drawFramebufferWidth=s,this.drawFramebufferHeight=a,this.drawFramebuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.drawFramebuffer),this.depthRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.depthRenderbuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,4,t.DEPTH_COMPONENT32F,this.drawFramebufferWidth,this.drawFramebufferHeight),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthRenderbuffer),this.colorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.colorRenderbuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,t.getParameter(t.MAX_SAMPLES),t.RGBA8,this.drawFramebufferWidth,this.drawFramebufferHeight),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,this.colorRenderbuffer),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&console.error("could not complete render framebuffer setup"),this.blitFramebuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.blitFramebuffer),this.depthTexture=u(this,br,Nr).call(this,t,t.NEAREST,t.NEAREST),t.bindTexture(t.TEXTURE_2D,this.depthTexture),t.texImage2D(this.gl.TEXTURE_2D,0,t.DEPTH_COMPONENT32F,this.drawFramebufferWidth,this.drawFramebufferHeight,0,t.DEPTH_COMPONENT,t.FLOAT,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,this.depthTexture,0),this.colorTexture=u(this,br,Nr).call(this,t,t.LINEAR,t.LINEAR),t.bindTexture(t.TEXTURE_2D,this.colorTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.drawFramebufferWidth,this.drawFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.colorTexture,0),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&console.error("could not complete render framebuffer setup"),this.dofPackedTexture=u(this,br,Nr).call(this,t,t.LINEAR,t.LINEAR),t.bindTexture(t.TEXTURE_2D,this.dofPackedTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.drawFramebufferWidth,this.drawFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),this.dofPackedFramebuffer=u(this,dr,Lr).call(this,t,[this.dofPackedTexture]),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&console.error("could not complete dof pack framebuffer setup"),this.dofFramebufferWidth=s*this.DOF_TEXTURE_SCALE,this.dofFramebufferHeight=a*this.DOF_TEXTURE_SCALE,this.dofBlurHMidFarTexture=u(this,br,Nr).call(this,t,t.LINEAR,t.LINEAR),t.bindTexture(t.TEXTURE_2D,this.dofBlurHMidFarTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.dofFramebufferWidth,this.dofFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),this.dofBlurHNearTexture=u(this,br,Nr).call(this,t,t.LINEAR,t.LINEAR),t.bindTexture(t.TEXTURE_2D,this.dofBlurHNearTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.dofFramebufferWidth,this.dofFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),this.dofBlurHFramebuffer=u(this,dr,Lr).call(this,t,[this.dofBlurHMidFarTexture,this.dofBlurHNearTexture]),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&console.error("could not complete dof blur horizontal framebuffer setup"),this.dofBlurVMidFarTexture=u(this,br,Nr).call(this,t,t.LINEAR,t.LINEAR),t.bindTexture(t.TEXTURE_2D,this.dofBlurVMidFarTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.dofFramebufferWidth,this.dofFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),this.dofBlurVNearTexture=u(this,br,Nr).call(this,t,t.LINEAR,t.LINEAR),t.bindTexture(t.TEXTURE_2D,this.dofBlurVNearTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.dofFramebufferWidth,this.dofFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),this.dofBlurVFramebuffer=u(this,dr,Lr).call(this,t,[this.dofBlurVMidFarTexture,this.dofBlurVNearTexture]),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&console.error("could not complete blur vertical framebuffer setup"),this.resize(),u(this,gr,jr).call(this),u(this,wr,Hr).call(this,t),this.initEnvMap(),u(this,cr,Br).call(this),u(this,xr,Kr).call(this),this.oninit&&this.oninit(this)}function Br(){this.pointerDown=!1,this.pointerDownPos={x:0,y:0},this.pointerPos={x:0,y:0},this.pointerFollowPos={x:0,y:0},this.prevPointerPos={x:0,y:0},this.phi=0,this.theta=0,this.canvas.style.touchAction="none",this.canvas.addEventListener("pointerdown",(t=>{this.pointerDownPos={x:t.clientX,y:t.clientY},this.pointerFollowPos={x:t.clientX,y:t.clientY},this.pointerPos={x:t.clientX,y:t.clientY},this.prevPointerPos={x:t.clientX,y:t.clientY},this.pointerDownCameraUp=[...this.camera.up],this.pointerDownRotation=[...this.camera.rotation],this.pointerDown=!0})),this.canvas.addEventListener("pointerup",(t=>{this.pointerDown=!1})),this.canvas.addEventListener("pointermove",(t=>{this.pointerDown&&(this.pointerPos={x:t.clientX,y:t.clientY})}))}function Vr(){if(this.pointerDown){const t=10;this.pointerFollowPos.x+=(this.pointerPos.x-this.pointerFollowPos.x)/t,this.pointerFollowPos.y+=(this.pointerPos.y-this.pointerFollowPos.y)/t;const e={x:this.pointerFollowPos.x-this.prevPointerPos.x,y:this.pointerFollowPos.y-this.prevPointerPos.y};this.prevPointerPos={...this.pointerFollowPos};const n=.2;this.phi=e.x*n,this.theta=e.y*n}else this.phi*=.96,this.theta*=.96;this.camera.rotation[0]-=this.theta,this.camera.rotation[1]-=this.phi;this.camera.rotation[0]>90?this.camera.rotation[0]=90:this.camera.rotation[0]<-90&&(this.camera.rotation[0]=-90),ce.fromEuler(this.camera.orbit,this.camera.rotation[0],this.camera.rotation[1],this.camera.rotation[2]),pe.transformQuat(this.camera.position,[0,0,this.camera.distance],this.camera.orbit),pe.transformQuat(this.camera.up,[0,1,0],this.camera.orbit),u(this,gr,jr).call(this)}function Lr(t,e){const n=t.createFramebuffer(),r=[];return t.bindFramebuffer(t.FRAMEBUFFER,n),e.forEach(((e,n)=>{const i=t[`COLOR_ATTACHMENT${n}`];t.framebufferTexture2D(t.FRAMEBUFFER,i,t.TEXTURE_2D,e,0),r.push(i)})),t.drawBuffers(r),t.bindFramebuffer(t.FRAMEBUFFER,null),n}function Dr(t,e,n){const r=t.createVertexArray();t.bindVertexArray(r);for(const[n,r,i]of e)-1!=r&&(t.bindBuffer(t.ARRAY_BUFFER,n),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,i,t.FLOAT,!1,0,0));return n&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n),t.bindVertexArray(null),r}function Ur(t,e,n){const r=t.createShader(e);t.shaderSource(r,n),t.compileShader(r);if(t.getShaderParameter(r,t.COMPILE_STATUS))return r;console.error(t.getShaderInfoLog(r)),t.deleteShader(r)}function Ir(t,e,n,r){const i=t.createProgram();if([t.VERTEX_SHADER,t.FRAGMENT_SHADER].forEach(((n,r)=>{const o=u(this,vr,Ur).call(this,t,n,e[r]);t.attachShader(i,o)})),n&&t.transformFeedbackVaryings(i,n,t.SEPARATE_ATTRIBS),r)for(const e in r)t.bindAttribLocation(i,r[e],e);t.linkProgram(i);if(t.getProgramParameter(i,t.LINK_STATUS))return i;console.error(t.getProgramInfoLog(i)),t.deleteProgram(i)}function Or(t,e,n,r){t.bindFramebuffer(t.FRAMEBUFFER,e),t.viewport(0,0,n,r)}function Nr(t,e,n){const r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n),r}function zr(t){const e=t.canvas.clientWidth,n=t.canvas.clientHeight;this.drawFramebufferWidth=e,this.drawFramebufferHeight=n,this.dofFramebufferWidth=e*this.DOF_TEXTURE_SCALE,this.dofFramebufferHeight=n*this.DOF_TEXTURE_SCALE,t.bindRenderbuffer(t.RENDERBUFFER,this.depthRenderbuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,4,t.DEPTH_COMPONENT32F,e,n),t.bindRenderbuffer(t.RENDERBUFFER,this.colorRenderbuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,t.getParameter(t.MAX_SAMPLES),t.RGBA8,e,n),t.bindTexture(t.TEXTURE_2D,this.depthTexture),t.texImage2D(this.gl.TEXTURE_2D,0,t.DEPTH_COMPONENT32F,e,n,0,t.DEPTH_COMPONENT,t.FLOAT,null),t.bindTexture(t.TEXTURE_2D,this.colorTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,n,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindTexture(t.TEXTURE_2D,this.dofPackedTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.drawFramebufferWidth,this.drawFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindTexture(t.TEXTURE_2D,this.dofBlurHNearTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.dofFramebufferWidth,this.dofFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindTexture(t.TEXTURE_2D,this.dofBlurHMidFarTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.dofFramebufferWidth,this.dofFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindTexture(t.TEXTURE_2D,this.dofBlurVNearTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.dofFramebufferWidth,this.dofFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindTexture(t.TEXTURE_2D,this.dofBlurVMidFarTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.dofFramebufferWidth,this.dofFramebufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindTexture(t.TEXTURE_2D,null)}function jr(){M.lookAt(this.camera.position,[0,0,0],this.camera.up,this.camera.matrix),M.inverse(this.camera.matrix,this.drawUniforms.u_viewMatrix)}function Hr(t){const e=t.canvas.clientWidth/t.canvas.clientHeight;M.perspective(Math.PI/4,e,this.camera.near,this.camera.far,this.drawUniforms.u_projectionMatrix)}function Kr(){if(this.pane){const t=700,e=this.pane.addFolder({title:"Camera"});u(this,Cr,Gr).call(this,e,this.camera,"near","near",1,t,null,(()=>u(this,wr,Hr).call(this,this.gl))),u(this,Cr,Gr).call(this,e,this.camera,"far","far",1,t,null,(()=>u(this,wr,Hr).call(this,this.gl)));const n=this.pane.addFolder({title:"DoF Settings"});u(this,Cr,Gr).call(this,n,this.dof,"maxCoCRadius","radius",0,30,1),u(this,Cr,Gr).call(this,n,this.dof,"radiusScale","radius scale",1,5,.1),u(this,Cr,Gr).call(this,n,this.dof,"nearBlurry","near blur",0,t),u(this,Cr,Gr).call(this,n,this.dof,"nearSharp","near sharp",0,t),u(this,Cr,Gr).call(this,n,this.dof,"farSharp","far sharp",0,t),u(this,Cr,Gr).call(this,n,this.dof,"farBlurry","far blur",0,t);const r=this.pane.addFolder({title:"Render Passes"});r.addInput(this,"enableRegionsPreview",{label:"regions"}),r.addInput(this,"enableFarMidPreview",{label:"far/mid"}),r.addInput(this,"enableNearPreview",{label:"near"}),r.addInput(this,"enablePackedPreview",{label:"packed"}),r.addInput(this,"enableCoCPreview",{label:"coc"}),u(this,Cr,Gr).call(this,r,this,"passPreviewSize","size",0,1)}}function Gr(t,e,n,r,i,o,s=null,a){t.addBlade({view:"slider",label:r,min:i,max:o,step:s,value:e[n]}).on("change",(t=>{e[n]=t.value,a&&a()}))}const Wr=window.location.search;let qr,Xr,Yr=null!==new URLSearchParams(Wr).get("debug");window.addEventListener("load",(()=>{const t=document.body.querySelector("#c");let e;Yr&&(e=new s.Pane({title:"Settings"})),qr=new Er(t,e,(t=>{t.run()}))})),window.addEventListener("resize",(()=>{qr&&(Xr&&clearTimeout(Xr),Xr=setTimeout((()=>{Xr=null,qr.resize()}),300))}));
//# sourceMappingURL=index.be9dbe4f.js.map
